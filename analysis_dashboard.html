<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Solution Analysis Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .chart-container h3 {
            margin-top: 0;
            color: #4a5568;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
        }
        
        .results-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .results-section h3 {
            margin-top: 0;
            color: #4a5568;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        
        th {
            background-color: #f7fafc;
            font-weight: 600;
            color: #4a5568;
        }
        
        tr:hover {
            background-color: #f7fafc;
        }
        
        .score {
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 4px;
            color: white;
        }
        
        .score.excellent { background-color: #48bb78; }
        .score.good { background-color: #38b2ac; }
        .score.average { background-color: #ed8936; }
        .score.poor { background-color: #e53e3e; }
        
        .llm-rank {
            font-size: 1.2em;
            font-weight: bold;
            color: #4a5568;
        }
        
        .details-toggle {
            background: #4299e1;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
        }
        
        .details-toggle:hover {
            background: #3182ce;
        }
        
        .details-content {
            display: none;
            margin-top: 10px;
            padding: 20px;
            background-color: #f7fafc;
            border-radius: 8px;
            border-left: 4px solid #4299e1;
        }
        
        .analysis-section {
            background: white;
            margin: 15px 0;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .analysis-section h4 {
            margin: 0 0 12px 0;
            color: #2d3748;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 8px;
            font-size: 1.1em;
        }
        
        .score-display {
            background: #4299e1;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
        }
        
        .key-points {
            margin: 0;
            padding: 0;
        }
        
        .key-points li {
            margin: 6px 0;
            padding: 4px 8px;
            border-radius: 4px;
            list-style: none;
            position: relative;
            padding-left: 25px;
        }
        
        .key-points li.positive {
            background-color: #f0fff4;
            border-left: 3px solid #38a169;
        }
        
        .key-points li.negative {
            background-color: #fffaf0;
            border-left: 3px solid #ed8936;
        }
        
        .key-points li.warning {
            background-color: #fef5e7;
            border-left: 3px solid #f6ad55;
        }
        
        .key-points li.info {
            background-color: #ebf8ff;
            border-left: 3px solid #4299e1;
        }
        
        .key-points li.success {
            background-color: #f0fff4;
            border-left: 3px solid #48bb78;
        }
        
        .key-points li.error {
            background-color: #fed7d7;
            border-left: 3px solid #e53e3e;
        }
        
        .file-structure {
            background: #f7fafc;
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
        }
        
        .file-structure ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .metric-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: #4299e1;
        }
        
        .metric-label {
            color: #718096;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        .weight-controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        
        .weight-controls h3 {
            margin-top: 0;
            color: #4a5568;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
        }
        
        .weight-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }
        
        .weight-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .weight-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            color: #2d3748;
        }
        
        .weight-value {
            background: #4299e1;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.85em;
            min-width: 45px;
            text-align: center;
        }
        
        .weight-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e2e8f0;
            outline: none;
            -webkit-appearance: none;
        }
        
        .weight-slider::-webkit-slider-thumb {
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #4299e1;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .weight-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #4299e1;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .weight-total {
            text-align: center;
            margin-top: 15px;
            padding: 10px;
            background: #f7fafc;
            border-radius: 8px;
            font-weight: 600;
        }
        
        .weight-warning {
            color: #e53e3e;
        }
        
        .weight-good {
            color: #38a169;
        }
        
        .weight-item.changing {
            background-color: #bee3f8;
            transform: scale(1.02);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .redistribution-info {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .weight-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 15px;
        }
        
        .modal-title {
            font-size: 1.5em;
            font-weight: 600;
            color: #2d3748;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 2em;
            color: #718096;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-modal:hover {
            color: #2d3748;
        }
        
        .modal-section {
            margin-bottom: 20px;
        }
        
        .modal-section h4 {
            color: #4a5568;
            margin-bottom: 10px;
        }
        
        .preset-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .preset-btn {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .preset-btn:hover {
            background: #edf2f7;
            border-color: #4299e1;
        }
        
        .preset-btn.active {
            background: #e6fffa;
            border-color: #38a169;
            color: #234e52;
        }
        
        .weight-help {
            background: #ebf8ff;
            border-left: 4px solid #4299e1;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        
        .redistribution-info {
            background: #fffaf0;
            border-left: 4px solid #ed8936;
            padding: 12px;
            border-radius: 6px;
            font-size: 0.9em;
            margin-top: 10px;
        }
        
        .weight-item.changing {
            background: #fef5e7;
            border-radius: 8px;
            padding: 8px;
            transition: background-color 0.3s;
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .metric-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ü§ñ LLM Solution Analysis Dashboard</h1>
        <p>Comprehensive comparison of AI-generated code solutions</p>
        <p><small>Generated on: 2025-08-16T15:07:21.312868</small></p>
    </div>
    
    <div class="metric-grid">
        <div class="metric-card">
            <div class="metric-value">4</div>
            <div class="metric-label">Solutions Analyzed</div>
        </div>
        <div class="metric-card">
            <div class="metric-value">7</div>
            <div class="metric-label">Analysis Dimensions</div>
        </div>
        <div class="metric-card">
            <div class="metric-value">83.9</div>
            <div class="metric-label">Highest Score</div>
        </div>
        <div class="metric-card">
            <div class="metric-value">81.0</div>
            <div class="metric-label">Average Score</div>
        </div>
    </div>
    
    <div class="weight-controls">
        <h3>‚öñÔ∏è Analysis Weight Controls</h3>
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <p style="color: #718096; margin: 0;">Adjust the importance of each analysis dimension - weights automatically balance to 100%</p>
            <button onclick="openWeightModal()" style="background: #4299e1; color: white; border: none; padding: 8px 15px; border-radius: 6px; cursor: pointer; font-size: 0.9em;">
                üí° Weight Guide
            </button>
        </div>
        
        <div class="weight-grid">
            
            <div class="weight-item">
                <div class="weight-label">
                    <span>üîß Adaptability</span>
                    <span class="weight-value" id="adaptability_value">10%</span>
                </div>
                <input type="range" min="0" max="50" value="10" 
                       class="weight-slider" id="adaptability_slider"
                       oninput="updateWeight('adaptability', 'Adaptability Analysis', this.value)">
            </div>
            
            <div class="weight-item">
                <div class="weight-label">
                    <span>üèóÔ∏è Code Quality</span>
                    <span class="weight-value" id="code_quality_value">10%</span>
                </div>
                <input type="range" min="0" max="50" value="10" 
                       class="weight-slider" id="code_quality_slider"
                       oninput="updateWeight('code_quality', 'Code Quality Analysis', this.value)">
            </div>
            
            <div class="weight-item">
                <div class="weight-label">
                    <span>üìö Documentation</span>
                    <span class="weight-value" id="documentation_value">5%</span>
                </div>
                <input type="range" min="0" max="50" value="5" 
                       class="weight-slider" id="documentation_slider"
                       oninput="updateWeight('documentation', 'Documentation Analysis', this.value)">
            </div>
            
            <div class="weight-item">
                <div class="weight-label">
                    <span>‚ö° Performance</span>
                    <span class="weight-value" id="performance_value">20%</span>
                </div>
                <input type="range" min="0" max="50" value="20" 
                       class="weight-slider" id="performance_slider"
                       oninput="updateWeight('performance', 'Performance Analysis', this.value)">
            </div>
            
            <div class="weight-item">
                <div class="weight-label">
                    <span>üìñ Readability</span>
                    <span class="weight-value" id="readability_value">15%</span>
                </div>
                <input type="range" min="0" max="50" value="15" 
                       class="weight-slider" id="readability_slider"
                       oninput="updateWeight('readability', 'Readability Analysis', this.value)">
            </div>
            
            <div class="weight-item">
                <div class="weight-label">
                    <span>üìã Requirements Traceability</span>
                    <span class="weight-value" id="requirements_traceability_value">25%</span>
                </div>
                <input type="range" min="0" max="50" value="25" 
                       class="weight-slider" id="requirements_traceability_slider"
                       oninput="updateWeight('requirements_traceability', 'Requirements Traceability Analysis', this.value)">
            </div>
            
            <div class="weight-item">
                <div class="weight-label">
                    <span>üîí Security</span>
                    <span class="weight-value" id="security_value">15%</span>
                </div>
                <input type="range" min="0" max="50" value="15" 
                       class="weight-slider" id="security_slider"
                       oninput="updateWeight('security', 'Security Analysis', this.value)">
            </div>
            
        </div>
        
        <div class="weight-total">
            Total Weight: <span id="totalWeight">100</span>%
            <span id="weightStatus" class="weight-good">‚úì Balanced</span>
        </div>
    </div>
    
    <!-- Weight Guide Modal -->
    <div id="weightModal" class="weight-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">‚öñÔ∏è Weight Distribution Guide</h3>
                <button class="close-modal" onclick="closeWeightModal()">&times;</button>
            </div>
            
            <div class="modal-section">
                <div class="weight-help">
                    <strong>üéØ How It Works:</strong><br>
                    When you adjust any weight, the system automatically redistributes the remaining weights proportionally to maintain 100% total.
                    This ensures fair comparison while respecting your priorities.
                </div>
            </div>
            
            <div class="modal-section">
                <h4>üìã Quick Presets</h4>
                <div class="preset-buttons">
                    <div class="preset-btn" onclick="applyPreset('balanced')">
                        <strong>üèõÔ∏è Balanced</strong><br>
                        <small>Equal focus on all dimensions</small>
                    </div>
                    <div class="preset-btn" onclick="applyPreset('security')">
                        <strong>üîí Security First</strong><br>
                        <small>Prioritize security & compliance</small>
                    </div>
                    <div class="preset-btn" onclick="applyPreset('performance')">
                        <strong>‚ö° Performance</strong><br>
                        <small>Speed & efficiency focused</small>
                    </div>
                    <div class="preset-btn" onclick="applyPreset('enterprise')">
                        <strong>üè¢ Enterprise</strong><br>
                        <small>Documentation & requirements</small>
                    </div>
                    <div class="preset-btn" onclick="applyPreset('agile')">
                        <strong>üöÄ Agile Development</strong><br>
                        <small>Adaptability & code quality</small>
                    </div>
                    <div class="preset-btn" onclick="applyPreset('maintenance')">
                        <strong>üîß Maintenance</strong><br>
                        <small>Readability & documentation</small>
                    </div>
                </div>
            </div>
            
            <div class="modal-section">
                <h4>üí° Tips</h4>
                <ul style="color: #4a5568; line-height: 1.6;">
                    <li><strong>Start with presets</strong> then fine-tune for your specific needs</li>
                    <li><strong>Watch the rankings change</strong> as you adjust weights</li>
                    <li><strong>Higher weights</strong> make that dimension more influential in the final score</li>
                    <li><strong>Zero weight</strong> excludes that dimension from scoring entirely</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div class="dashboard-grid">
        <div class="chart-container">
            <h3>üìä Overall Performance Ranking</h3>
            <canvas id="overallChart"></canvas>
        </div>
        
        <div class="chart-container">
            <h3>üìà Category Performance Comparison</h3>
            <canvas id="categoryChart"></canvas>
        </div>
    </div>
    
    <div class="results-section">
        <h3>üìã Detailed Results</h3>
        
        <table>
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>LLM</th>
                    <th>Overall</th>
                    <th>Adaptability</th><th>Code Quality</th><th>Documentation</th><th>Performance</th><th>Readability</th><th>Requirements Traceability</th><th>Security</th>
                    <th>Details</th>
                </tr>
            </thead>
            <tbody>
                
                <tr>
                    <td class="llm-rank" id="rank-llm1">#1</td>
                    <td><strong>llm1</strong></td>
                    <td><span class="score good" id="score-llm1">83.9</span></td>
                    <td>39.5</td><td>75.0</td><td>70.0</td><td>74.0</td><td>93.0</td><td>99.5</td><td>100.0</td>
                    <td>
                        <button class="details-toggle" onclick="toggleDetails('details-llm1')">
                            View Details
                        </button>
                    </td>
                </tr>
                <tr>
                    <td colspan="11">
                        <div id="details-llm1" class="details-content">
                            <div class="analysis-section"><h4>üìÅ File Structure</h4><div class="file-structure"><ul><li><strong>Find-SafeToDeleteFiles.ps1</strong>: 127 lines, 5,138 bytes</li></ul></div></div><div class="analysis-grid"><div class="analysis-section"><h4>üîß Adaptability Analysis</h4><div class="score-display">39.5/100</div><ul class="key-points"><li class="info">Configuration Flexibility: 90.0/100</li><li class="info">Cross-Platform Compatibility: 20.0/100</li><li class="info">Extensibility: 20.0/100</li><li class="info">Environment Adaptation: 0.0/100</li><li class="info">Input/Output Flexibility: 60.0/100</li><li class="error">Error Recovery: 30.0/100</li><li class="positive">‚úì Excellent configuration options</li><li class="negative">‚ùå Platform-specific limitations</li><li class="negative">‚ùå Limited extensibility</li></ul></div><div class="analysis-section"><h4>üèóÔ∏è Code Quality Analysis</h4><div class="score-display">75.0/100</div><ul class="key-points"><li class="positive">+ Implements try-catch error handling</li><li class="positive">+ Uses Parameter attributes</li><li class="positive">+ Has mandatory parameters</li><li class="positive">+ Supports pipeline input</li><li class="positive">+ Uses type hints (3 found)</li></ul></div><div class="analysis-section"><h4>üìö Documentation Analysis</h4><div class="score-display">70.0/100</div><ul class="key-points"><li class="negative">- No README documentation found</li><li class="positive">+ Adequate inline commenting (>5% average)</li><li class="positive">+ Good use of section comments</li><li class="positive">+ All PowerShell files have help documentation</li><li class="positive">+ 1 files have comprehensive help (4+ sections)</li></ul></div><div class="analysis-section"><h4>‚ö° Performance Analysis</h4><div class="score-display">74.0/100</div><ul class="key-points"><li class="positive">+ Uses ErrorAction SilentlyContinue (prevents performance hits from errors)</li><li class="positive">+ Uses -File parameter for efficient enumeration</li><li class="positive">+ Supports recursive scanning</li><li class="positive">+ Implements result limiting for memory efficiency</li><li class="positive">+ Uses efficient .NET Generic Collections</li></ul></div><div class="analysis-section"><h4>üìñ Readability Analysis</h4><div class="score-display">93.0/100</div><ul class="key-points"><li class="info">Adequate commenting (>5% comment ratio)</li><li class="info">Includes PowerShell help documentation</li><li class="positive">Comprehensive help documentation</li><li class="info">Uses descriptive variable names</li><li class="positive">Good logical sectioning with comments</li></ul></div><div class="analysis-section"><h4>üìã Requirements Traceability Analysis</h4><div class="score-display">99.5/100</div><ul class="key-points"><li class="success">Requirements Implementation: 10/10 (100.0%)</li><li class="success">Mandatory Requirements: 10/10 (100.0%)</li><li class="positive">‚úì All mandatory requirements implemented</li><li class="positive">‚úì Excellent implementation quality</li><li class="info">üìä SCORING METHODOLOGY INSIGHTS:</li><li class="info">‚Ä¢ Requirements compliance (binary pass/fail) ‚â† implementation quality (0-100)</li><li class="info">‚Ä¢ Quality scores based on evidence count + implementation depth</li><li class="info">‚Ä¢ Higher evidence count = stronger confidence in requirement fulfillment</li><li class="info">‚Ä¢ Even 'PASS' requirements can vary in quality (94-100% range observed)</li><li class="positive">‚Ä¢ Comprehensive implementations score higher than minimal implementations</li><li class="info">‚Ä¢ Example: REQ-006 parameter tracking - detailed vs simple approaches affect scoring</li></ul></div><div class="analysis-section"><h4>üîí Security Analysis</h4><div class="score-display">100.0/100</div><ul class="key-points"><li class="positive">‚úì No critical security vulnerabilities detected</li><li class="positive">‚úì No high-risk security issues detected</li><li class="warning">‚ö° 2 MEDIUM risk security issues found</li><li class="info">‚ö™ Some security practices found (2 detected)</li><li class="negative">- MEDIUM: Input Validation (1 instances)</li><li class="negative">- MEDIUM: Error Handling (1 instances)</li><li class="positive">+ Safe File Operations: 1 instances</li><li class="positive">+ Logging Auditing: 1 instances</li></ul></div></div>
                        </div>
                    </td>
                </tr>
            
                <tr>
                    <td class="llm-rank" id="rank-llm4">#2</td>
                    <td><strong>llm4</strong></td>
                    <td><span class="score good" id="score-llm4">82.9</span></td>
                    <td>13.5</td><td>95.0</td><td>100.0</td><td>62.0</td><td>100.0</td><td>99.5</td><td>100.0</td>
                    <td>
                        <button class="details-toggle" onclick="toggleDetails('details-llm4')">
                            View Details
                        </button>
                    </td>
                </tr>
                <tr>
                    <td colspan="11">
                        <div id="details-llm4" class="details-content">
                            <div class="analysis-section"><h4>üìÅ File Structure</h4><div class="file-structure"><ul><li><strong>create-test-files.bat</strong>: 51 lines, 1,561 bytes</li><li><strong>README.md</strong>: 192 lines, 7,077 bytes</li><li><strong>run-analyzer.bat</strong>: 51 lines, 1,577 bytes</li><li><strong>Safe-Delete-Analyzer.ps1</strong>: 361 lines, 11,832 bytes</li></ul></div></div><div class="analysis-grid"><div class="analysis-section"><h4>üîß Adaptability Analysis</h4><div class="score-display">13.5/100</div><ul class="key-points"><li class="info">Configuration Flexibility: 25.0/100</li><li class="info">Cross-Platform Compatibility: 5.0/100</li><li class="info">Extensibility: 15.0/100</li><li class="info">Environment Adaptation: 5.0/100</li><li class="info">Input/Output Flexibility: 15.0/100</li><li class="error">Error Recovery: 10.0/100</li><li class="negative">‚ùå Limited configuration options</li><li class="negative">‚ùå Platform-specific limitations</li><li class="negative">‚ùå Limited extensibility</li></ul></div><div class="analysis-section"><h4>üèóÔ∏è Code Quality Analysis</h4><div class="score-display">95.0/100</div><ul class="key-points"><li class="positive">+ Implements try-catch error handling</li><li class="positive">+ Uses Parameter attributes</li><li class="positive">+ Supports pipeline input</li><li class="positive">+ Uses type hints (6 found)</li><li class="positive">+ Well-organized with 2 functions</li></ul></div><div class="analysis-section"><h4>üìö Documentation Analysis</h4><div class="score-display">100.0/100</div><ul class="key-points"><li class="positive">+ Includes README documentation</li><li class="positive">+ README contains: usage, examples, features, installation, parameters</li><li class="positive">+ README includes code examples</li><li class="positive">+ Comprehensive README documentation</li><li class="positive">+ Adequate inline commenting (>5% average)</li></ul></div><div class="analysis-section"><h4>‚ö° Performance Analysis</h4><div class="score-display">62.0/100</div><ul class="key-points"><li class="positive">+ Uses ErrorAction SilentlyContinue (prevents performance hits from errors)</li><li class="positive">+ Uses -File parameter for efficient enumeration</li><li class="positive">+ Implements result limiting for memory efficiency</li><li class="positive">+ Shows evidence of caching/pre-computation</li><li class="negative">- String operations in loops may impact performance</li></ul></div><div class="analysis-section"><h4>üìñ Readability Analysis</h4><div class="score-display">100.0/100</div><ul class="key-points"><li class="info">Adequate commenting (>5% comment ratio)</li><li class="info">Includes PowerShell help documentation</li><li class="positive">Comprehensive help documentation</li><li class="info">Uses descriptive variable names</li><li class="info">Well-organized with 2 functions</li></ul></div><div class="analysis-section"><h4>üìã Requirements Traceability Analysis</h4><div class="score-display">99.5/100</div><ul class="key-points"><li class="success">Requirements Implementation: 10/10 (100.0%)</li><li class="success">Mandatory Requirements: 10/10 (100.0%)</li><li class="positive">‚úì All mandatory requirements implemented</li><li class="positive">‚úì Excellent implementation quality</li><li class="info">üìä SCORING METHODOLOGY INSIGHTS:</li><li class="info">‚Ä¢ Requirements compliance (binary pass/fail) ‚â† implementation quality (0-100)</li><li class="info">‚Ä¢ Quality scores based on evidence count + implementation depth</li><li class="info">‚Ä¢ Higher evidence count = stronger confidence in requirement fulfillment</li><li class="info">‚Ä¢ Even 'PASS' requirements can vary in quality (94-100% range observed)</li><li class="positive">‚Ä¢ Comprehensive implementations score higher than minimal implementations</li><li class="info">‚Ä¢ Example: REQ-006 parameter tracking - detailed vs simple approaches affect scoring</li></ul></div><div class="analysis-section"><h4>üîí Security Analysis</h4><div class="score-display">100.0/100</div><ul class="key-points"><li class="positive">‚úì No critical security vulnerabilities detected</li><li class="positive">‚úì No high-risk security issues detected</li><li class="warning">‚ö° 4 MEDIUM risk security issues found</li><li class="info">‚ö™ Some security practices found (5 detected)</li><li class="negative">- MEDIUM: Input Validation (3 instances)</li><li class="negative">- MEDIUM: Error Handling (1 instances)</li><li class="positive">+ Safe File Operations: 2 instances</li><li class="positive">+ Logging Auditing: 3 instances</li></ul></div></div>
                        </div>
                    </td>
                </tr>
            
                <tr>
                    <td class="llm-rank" id="rank-llm3">#3</td>
                    <td><strong>llm3</strong></td>
                    <td><span class="score good" id="score-llm3">81.5</span></td>
                    <td>31.8</td><td>78.0</td><td>100.0</td><td>55.0</td><td>100.0</td><td>99.5</td><td>100.0</td>
                    <td>
                        <button class="details-toggle" onclick="toggleDetails('details-llm3')">
                            View Details
                        </button>
                    </td>
                </tr>
                <tr>
                    <td colspan="11">
                        <div id="details-llm3" class="details-content">
                            <div class="analysis-section"><h4>üìÅ File Structure</h4><div class="file-structure"><ul><li><strong>README_FileDeletionSafetyReport.md</strong>: 68 lines, 3,144 bytes</li><li><strong>FileDeletionSafetyReport.ps1</strong>: 230 lines, 9,575 bytes</li></ul></div></div><div class="analysis-grid"><div class="analysis-section"><h4>üîß Adaptability Analysis</h4><div class="score-display">31.8/100</div><ul class="key-points"><li class="info">Configuration Flexibility: 65.0/100</li><li class="info">Cross-Platform Compatibility: 20.0/100</li><li class="info">Extensibility: 30.0/100</li><li class="info">Environment Adaptation: 0.0/100</li><li class="info">Input/Output Flexibility: 35.0/100</li><li class="error">Error Recovery: 20.0/100</li><li class="positive">‚ö° Good configuration flexibility</li><li class="negative">‚ùå Platform-specific limitations</li><li class="negative">‚ùå Limited extensibility</li></ul></div><div class="analysis-section"><h4>üèóÔ∏è Code Quality Analysis</h4><div class="score-display">78.0/100</div><ul class="key-points"><li class="positive">+ Uses ErrorAction for error handling</li><li class="positive">+ Uses Parameter attributes</li><li class="positive">+ Uses type hints (16 found)</li><li class="positive">+ Well-organized with 1 functions</li><li class="positive">+ Consistent code indentation</li></ul></div><div class="analysis-section"><h4>üìö Documentation Analysis</h4><div class="score-display">100.0/100</div><ul class="key-points"><li class="positive">+ Includes README documentation</li><li class="positive">+ README contains: usage, examples, features, parameters</li><li class="positive">+ README includes code examples</li><li class="positive">+ Comprehensive README documentation</li><li class="positive">+ Adequate inline commenting (>5% average)</li></ul></div><div class="analysis-section"><h4>‚ö° Performance Analysis</h4><div class="score-display">55.0/100</div><ul class="key-points"><li class="positive">+ Uses ErrorAction SilentlyContinue (prevents performance hits from errors)</li><li class="positive">+ Implements result limiting for memory efficiency</li><li class="positive">+ Shows evidence of caching/pre-computation</li><li class="negative">- Multiple Where-Object filters (2) after enumeration</li><li class="negative">- String operations in loops may impact performance</li></ul></div><div class="analysis-section"><h4>üìñ Readability Analysis</h4><div class="score-display">100.0/100</div><ul class="key-points"><li class="info">Adequate commenting (>5% comment ratio)</li><li class="info">Includes PowerShell help documentation</li><li class="positive">Comprehensive help documentation</li><li class="info">Uses descriptive variable names</li><li class="info">Well-organized with 1 functions</li></ul></div><div class="analysis-section"><h4>üìã Requirements Traceability Analysis</h4><div class="score-display">99.5/100</div><ul class="key-points"><li class="success">Requirements Implementation: 10/10 (100.0%)</li><li class="success">Mandatory Requirements: 10/10 (100.0%)</li><li class="positive">‚úì All mandatory requirements implemented</li><li class="positive">‚úì Excellent implementation quality</li><li class="info">üìä SCORING METHODOLOGY INSIGHTS:</li><li class="info">‚Ä¢ Requirements compliance (binary pass/fail) ‚â† implementation quality (0-100)</li><li class="info">‚Ä¢ Quality scores based on evidence count + implementation depth</li><li class="info">‚Ä¢ Higher evidence count = stronger confidence in requirement fulfillment</li><li class="info">‚Ä¢ Even 'PASS' requirements can vary in quality (94-100% range observed)</li><li class="positive">‚Ä¢ Comprehensive implementations score higher than minimal implementations</li><li class="info">‚Ä¢ Example: REQ-006 parameter tracking - detailed vs simple approaches affect scoring</li></ul></div><div class="analysis-section"><h4>üîí Security Analysis</h4><div class="score-display">100.0/100</div><ul class="key-points"><li class="positive">‚úì No critical security vulnerabilities detected</li><li class="positive">‚úì No high-risk security issues detected</li><li class="warning">‚ö° 3 MEDIUM risk security issues found</li><li class="info">‚ö™ Some security practices found (4 detected)</li><li class="negative">- MEDIUM: Input Validation (2 instances)</li><li class="negative">- MEDIUM: Error Handling (1 instances)</li><li class="positive">+ Safe File Operations: 3 instances</li><li class="positive">+ Logging Auditing: 1 instances</li></ul></div></div>
                        </div>
                    </td>
                </tr>
            
                <tr>
                    <td class="llm-rank" id="rank-llm2">#4</td>
                    <td><strong>llm2</strong></td>
                    <td><span class="score average" id="score-llm2">75.8</span></td>
                    <td>27.5</td><td>64.0</td><td>60.0</td><td>55.0</td><td>93.0</td><td>98.9</td><td>94.0</td>
                    <td>
                        <button class="details-toggle" onclick="toggleDetails('details-llm2')">
                            View Details
                        </button>
                    </td>
                </tr>
                <tr>
                    <td colspan="11">
                        <div id="details-llm2" class="details-content">
                            <div class="analysis-section"><h4>üìÅ File Structure</h4><div class="file-structure"><ul><li><strong>SafeDeleteReport.ps1</strong>: 60 lines, 2,613 bytes</li></ul></div></div><div class="analysis-grid"><div class="analysis-section"><h4>üîß Adaptability Analysis</h4><div class="score-display">27.5/100</div><ul class="key-points"><li class="info">Configuration Flexibility: 50.0/100</li><li class="info">Cross-Platform Compatibility: 0.0/100</li><li class="info">Extensibility: 40.0/100</li><li class="info">Environment Adaptation: 0.0/100</li><li class="info">Input/Output Flexibility: 40.0/100</li><li class="error">Error Recovery: 30.0/100</li><li class="negative">‚ùå Limited configuration options</li><li class="negative">‚ùå Platform-specific limitations</li><li class="negative">‚ùå Limited extensibility</li></ul></div><div class="analysis-section"><h4>üèóÔ∏è Code Quality Analysis</h4><div class="score-display">64.0/100</div><ul class="key-points"><li class="positive">+ Uses ErrorAction for error handling</li><li class="positive">+ Uses type hints (2 found)</li><li class="positive">+ Well-organized with 1 functions</li><li class="positive">+ Consistent code indentation</li><li class="positive">+ Uses approved PowerShell verbs</li></ul></div><div class="analysis-section"><h4>üìö Documentation Analysis</h4><div class="score-display">60.0/100</div><ul class="key-points"><li class="negative">- No README documentation found</li><li class="positive">+ Excellent inline commenting (>15% average)</li><li class="positive">+ All files have header comments</li><li class="positive">+ Good use of section comments</li><li class="negative">- No PowerShell help documentation found</li></ul></div><div class="analysis-section"><h4>‚ö° Performance Analysis</h4><div class="score-display">55.0/100</div><ul class="key-points"><li class="positive">+ Uses ErrorAction SilentlyContinue (prevents performance hits from errors)</li><li class="positive">+ Uses -File parameter for efficient enumeration</li><li class="positive">+ Supports recursive scanning</li><li class="negative">- String operations in loops may impact performance</li></ul></div><div class="analysis-section"><h4>üìñ Readability Analysis</h4><div class="score-display">93.0/100</div><ul class="key-points"><li class="positive">Excellent commenting (>15% comment ratio)</li><li class="info">Uses descriptive variable names</li><li class="info">Well-organized with 1 functions</li><li class="positive">Good logical sectioning with comments</li><li class="positive">Good code indentation</li></ul></div><div class="analysis-section"><h4>üìã Requirements Traceability Analysis</h4><div class="score-display">98.9/100</div><ul class="key-points"><li class="success">Requirements Implementation: 10/10 (100.0%)</li><li class="success">Mandatory Requirements: 10/10 (100.0%)</li><li class="positive">‚úì All mandatory requirements implemented</li><li class="positive">‚úì Excellent implementation quality</li><li class="info">üìä SCORING METHODOLOGY INSIGHTS:</li><li class="info">‚Ä¢ Requirements compliance (binary pass/fail) ‚â† implementation quality (0-100)</li><li class="info">‚Ä¢ Quality scores based on evidence count + implementation depth</li><li class="info">‚Ä¢ Higher evidence count = stronger confidence in requirement fulfillment</li><li class="info">‚Ä¢ Even 'PASS' requirements can vary in quality (94-100% range observed)</li><li class="positive">‚Ä¢ Comprehensive implementations score higher than minimal implementations</li><li class="info">‚Ä¢ Example: REQ-006 parameter tracking - detailed vs simple approaches affect scoring</li></ul></div><div class="analysis-section"><h4>üîí Security Analysis</h4><div class="score-display">94.0/100</div><ul class="key-points"><li class="positive">‚úì No critical security vulnerabilities detected</li><li class="positive">‚úì No high-risk security issues detected</li><li class="warning">‚ö° 3 MEDIUM risk security issues found</li><li class="negative">‚ùå No security best practices detected</li><li class="negative">- MEDIUM: Input Validation (2 instances)</li><li class="negative">- MEDIUM: Error Handling (1 instances)</li></ul></div></div>
                        </div>
                    </td>
                </tr>
            
            </tbody>
        </table>
        
    </div>
    
    <script>
        // Weight management with smart redistribution
        let currentWeights = {
            "Adaptability Analysis": 10,
            "Code Quality Analysis": 10,
            "Documentation Analysis": 5,
            "Performance Analysis": 20,
            "Readability Analysis": 15,
            "Requirements Traceability Analysis": 25,
            "Security Analysis": 15
        };
        
        let originalScores = [{"llm_name": "llm1", "files": [{"path": "d:\\CodingModel\\ModelCompare\\FirstPassModelCompare\\llm1\\Find-SafeToDeleteFiles.ps1", "size": 5138, "lines": 127, "content": "<#\n.SYNOPSIS\n    Analyzes files in a specified directory and ranks them by how safe they might be to delete.\n\n.DESCRIPTION\n    This script recursively scans a directory to identify files that could be candidates for deletion.\n    It calculates a \"Safety Score\" based on criteria such as file age (LastWriteTime), file type (e.g., .log, .tmp),\n    and location (e.g., Temp folders).\n\n    The script does NOT delete any files. It produces a report that includes:\n    - SafetyScore: A calculated score. Higher is \"safer\".\n    - ScoreParameters: The reasons contributing to the score.\n    - Name: The file's name.\n    - FullName: The file's full path.\n    - Size(KB): The file's size in kilobytes.\n    - CreationTime: The date the file was created.\n    - LastWriteTime: The date the file was last modified.\n\n.PARAMETER Path\n    The directory path to scan for files. Defaults to the user's home directory ('~').\n\n.PARAMETER Top\n    The number of files to include in the final report, ranked by safety score. Defaults to 50.\n\n.EXAMPLE\n    PS C:\\> .\\Find-SafeToDeleteFiles.ps1 -Path \"C:\\Users\\YourUser\\Downloads\" -Top 20\n\n    This command scans the \"Downloads\" folder and lists the top 20 files considered safest to delete.\n\n.EXAMPLE\n    PS C:\\> .\\Find-SafeToDeleteFiles.ps1 | Export-Csv -Path \"C:\\Reports\\SafeToDelete.csv\" -NoTypeInformation\n\n    This command scans the user's home directory and exports the full report to a CSV file.\n#>\n[CmdletBinding()]\nparam (\n    [Parameter(Mandatory = $false, ValueFromPipeline = $true, Position = 0)]\n    [string]$Path = \"~\",\n\n    [Parameter(Mandatory = $false)]\n    [int]$Top = 50\n)\n\n# Resolve the path to an absolute path\n$targetPath = Resolve-Path -Path $Path\n\nWrite-Host \"Starting analysis of files in: $targetPath\" -ForegroundColor Green\nWrite-Host \"This script only identifies files and does not perform any delete operations.\" -ForegroundColor Yellow\n\n# Define criteria for the safety score\n$tempExtensions = @('.tmp', '.log', '.bak', '.old', '.dmp', '._mp', '.chk', '.gid', '.syd')\n$tempLocations = @(\n    [System.IO.Path]::GetFullPath($env:TEMP),\n    [System.IO.Path]::GetFullPath([System.IO.Path]::Combine($env:windir, \"Temp\"))\n)\n\ntry {\n    # Get all files recursively, ignoring errors for paths that are too long or inaccessible\n    $files = Get-ChildItem -Path $targetPath -Recurse -File -ErrorAction SilentlyContinue\n\n    $report = foreach ($file in $files) {\n        $safetyScore = 0\n        $scoreParameters = [System.Collections.Generic.List[string]]@()\n\n        # 1. Score based on LastWriteTime (Age)\n        $ageInDays = (Get-Date) - $file.LastWriteTime | Select-Object -ExpandProperty Days\n        if ($ageInDays -gt 365) {\n            $safetyScore += 50\n            $scoreParameters.Add(\"Over 1 year old\")\n        }\n        elseif ($ageInDays -gt 180) {\n            $safetyScore += 25\n            $scoreParameters.Add(\"Over 6 months old\")\n        }\n        elseif ($ageInDays -gt 30) {\n            $safetyScore += 10\n            $scoreParameters.Add(\"Over 1 month old\")\n        }\n\n        # 2. Score based on file extension\n        if ($tempExtensions -contains $file.Extension) {\n            $safetyScore += 30\n            $scoreParameters.Add(\"Temp Extension ($($file.Extension))\")\n        }\n\n        # 3. Score based on file location\n        foreach ($loc in $tempLocations) {\n            if ($file.FullName.StartsWith($loc, [System.StringComparison]::OrdinalIgnoreCase)) {\n                $safetyScore += 40\n                $scoreParameters.Add(\"In Temp Location\")\n                break # Stop after first match\n            }\n        }\n        \n        # 4. Score based on file attributes (e.g., temporary)\n        if ($file.Attributes -band [System.IO.FileAttributes]::Temporary) {\n            $safetyScore += 20\n            $scoreParameters.Add(\"Temporary Attribute\")\n        }\n\n        # Create a custom object for the report\n        [PSCustomObject]@{\n            SafetyScore     = $safetyScore\n            ScoreParameters = $scoreParameters -join ', '\n            Name            = $file.Name\n            \"Size(KB)\"      = [math]::Round($file.Length / 1KB, 2)\n            CreationTime    = $file.CreationTime\n            LastWriteTime   = $file.LastWriteTime\n            FullName        = $file.FullName\n        }\n    }\n\n    # Sort the report by safety score (descending) and select the top results\n    $sortedReport = $report | Sort-Object -Property SafetyScore -Descending | Select-Object -First $Top\n\n    Write-Host \"`nAnalysis Complete. Top $Top files ranked by deletion safety score:`n\" -ForegroundColor Green\n    \n    # Display the report in a formatted table\n    $sortedReport | Format-Table -AutoSize\n\n    Write-Host \"`nTo export the full report to a CSV file, you can pipe the script's output to Export-Csv.\" -ForegroundColor Cyan\n    Write-Host \"Example: .\\Find-SafeToDeleteFiles.ps1 -Path '$targetPath' | Export-Csv -Path '.\\FileReport.csv' -NoTypeInformation\" -ForegroundColor Cyan\n\n}\ncatch {\n    Write-Error \"An error occurred: $_\"\n}\n"}], "analysis_scores": {"Performance Analysis": {"score": 74, "max_score": 100.0, "notes": ["+ Uses ErrorAction SilentlyContinue (prevents performance hits from errors)", "+ Uses -File parameter for efficient enumeration", "+ Supports recursive scanning", "+ Implements result limiting for memory efficiency", "+ Uses efficient .NET Generic Collections", "- String operations in loops may impact performance", "+ Good balance of features and performance", "- Contains nested loops (1) - potential O(n\u00b2) complexity"], "details": {"total_lines": 127, "has_error_action": true, "uses_file_parameter": true, "supports_recursion": true, "has_result_limiting": true, "uses_generic_collections": true, "string_ops_in_loops": true, "complexity_level": "balanced", "nested_loops": 1, "algorithmic_complexity": "O(n\u00b2)"}}, "Readability Analysis": {"score": 93, "max_score": 100.0, "notes": ["Adequate commenting (>5% comment ratio)", "Includes PowerShell help documentation", "Comprehensive help documentation", "Uses descriptive variable names", "Good logical sectioning with comments", "Good code indentation"], "details": {"comment_ratio": 0.08661417322834646, "comment_lines": 11, "has_help_block": true, "help_sections_count": 4, "total_variables": 58, "meaningful_variable_ratio": 1.0, "short_variables": [], "function_count": 0, "section_comments": 6, "indentation_ratio": 0.6456692913385826, "mixed_indentation": false}}, "Code Quality Analysis": {"score": 75, "max_score": 100.0, "notes": ["+ Implements try-catch error handling", "+ Uses Parameter attributes", "+ Has mandatory parameters", "+ Supports pipeline input", "+ Uses type hints (3 found)", "+ Consistent code indentation", "+ Uses CmdletBinding for advanced functions", "+ Reasonable line lengths (<10% over 120 chars)", "+ Good variable naming practices"], "details": {"has_try_catch": true, "error_handling_score": 15, "has_parameter_attributes": true, "has_mandatory_params": true, "supports_pipeline": true, "type_hints_count": 3, "has_type_hints": true, "param_validation_score": 20, "function_count": 0, "has_consistent_indentation": true, "organization_score": 5, "has_cmdletbinding": true, "powershell_practices_score": 5, "long_line_ratio": 0.015748031496062992, "meaningful_variable_ratio": 1.0, "maintainability_score": 10}}, "Documentation Analysis": {"score": 70, "max_score": 100.0, "notes": ["- No README documentation found", "+ Adequate inline commenting (>5% average)", "+ Good use of section comments", "+ All PowerShell files have help documentation", "+ 1 files have comprehensive help (4+ sections)"], "details": {"readme_count": 0, "has_readme": false, "readme_analysis_score": 0, "average_comment_density": 0.08661417322834646, "files_with_headers": 0, "section_comments": 10, "inline_analysis_score": 10, "files_with_help": 1, "comprehensive_help_files": 1, "total_ps1_files": 1, "help_coverage": 1.0, "help_analysis_score": 30}}, "Requirements Traceability Analysis": {"score": 99.5, "max_score": ["Requirements Implementation: 10/10 (100.0%)", "Mandatory Requirements: 10/10 (100.0%)", "\u2713 All mandatory requirements implemented", "\u2713 Excellent implementation quality", "", "\ud83d\udcca SCORING METHODOLOGY INSIGHTS:", "\u2022 Requirements compliance (binary pass/fail) \u2260 implementation quality (0-100)", "\u2022 Quality scores based on evidence count + implementation depth", "\u2022 Higher evidence count = stronger confidence in requirement fulfillment", "\u2022 Even 'PASS' requirements can vary in quality (94-100% range observed)", "\u2022 Comprehensive implementations score higher than minimal implementations", "\u2022 Example: REQ-006 parameter tracking - detailed vs simple approaches affect scoring"], "notes": {"requirements_total": 10, "requirements_implemented": 10, "mandatory_requirements": 10, "mandatory_implemented": 10, "traceability_matrix": {"requirements": {"REQ-001": {"text": "Script must run on Windows platform", "type": "platform", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 3, "status": "\u2713 PASS"}, "REQ-002": {"text": "Must identify files that are safe to delete", "type": "functionality", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 5, "status": "\u2713 PASS"}, "REQ-003": {"text": "Must NOT actually delete files (identification only)", "type": "safety", "mandatory": true, "implemented": true, "quality_score": 95, "evidence_count": 2, "status": "\u2713 PASS"}, "REQ-004": {"text": "Must provide ranking/scoring of safety level", "type": "functionality", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 5, "status": "\u2713 PASS"}, "REQ-005": {"text": "Report must include safety-score field", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 3, "status": "\u2713 PASS"}, "REQ-006": {"text": "Report must include parameters that went into score consideration", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-007": {"text": "Report must include file name", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 3, "status": "\u2713 PASS"}, "REQ-008": {"text": "Report must include file size", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-009": {"text": "Report must include date created", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-010": {"text": "Report must include date updated/modified", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 3, "status": "\u2713 PASS"}}, "summary": {"total_requirements": 10, "implemented": 10, "not_implemented": 0, "mandatory_met": 10, "optional_met": 0}}, "requirement_traces": [{"id": "REQ-001", "text": "Script must run on Windows platform", "implemented": true, "quality": 100, "evidence_count": 3}, {"id": "REQ-002", "text": "Must identify files that are safe to delete", "implemented": true, "quality": 100, "evidence_count": 5}, {"id": "REQ-003", "text": "Must NOT actually delete files (identification only)", "implemented": true, "quality": 95, "evidence_count": 2}, {"id": "REQ-004", "text": "Must provide ranking/scoring of safety level", "implemented": true, "quality": 100, "evidence_count": 5}, {"id": "REQ-005", "text": "Report must include safety-score field", "implemented": true, "quality": 100, "evidence_count": 3}, {"id": "REQ-006", "text": "Report must include parameters that went into score consideration", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-007", "text": "Report must include file name", "implemented": true, "quality": 100, "evidence_count": 3}, {"id": "REQ-008", "text": "Report must include file size", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-009", "text": "Report must include date created", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-010", "text": "Report must include date updated/modified", "implemented": true, "quality": 100, "evidence_count": 3}]}, "details": {}}, "Security Analysis": {"score": 100, "max_score": ["\u2713 No critical security vulnerabilities detected", "\u2713 No high-risk security issues detected", "\u26a1 2 MEDIUM risk security issues found", "\u26aa Some security practices found (2 detected)", "- MEDIUM: Input Validation (1 instances)", "- MEDIUM: Error Handling (1 instances)", "+ Safe File Operations: 1 instances", "+ Logging Auditing: 1 instances"], "notes": {"security_issues": {"MEDIUM_input_validation": ["param (\n    [Parameter(Mandatory = $false, ValueFromPipeline = $true, Position = 0)"], "MEDIUM_error_handling": ["-ErrorAction SilentlyContinue"]}, "good_practices": {"safe_file_operations": ["Resolve-Path"], "logging_auditing": ["Write-Error"]}, "files_analyzed": 1, "total_content_length": 5012, "security_score_breakdown": {"critical_issues": 0, "high_risk_issues": 0, "medium_risk_issues": 2, "good_practices_count": 2, "security_categories_analyzed": 11, "practice_categories_found": 2}}, "details": {}}, "Adaptability Analysis": {"score": 39.5, "max_score": ["Configuration Flexibility: 90.0/100", "Cross-Platform Compatibility: 20.0/100", "Extensibility: 20.0/100", "Environment Adaptation: 0.0/100", "Input/Output Flexibility: 60.0/100", "Error Recovery: 30.0/100", "\u2713 Excellent configuration options", "\u274c Platform-specific limitations", "\u274c Limited extensibility"], "notes": {"configuration_score": 90.0, "cross_platform_score": 20.0, "extensibility_score": 20.0, "environment_adaptation_score": 0.0, "input_output_flexibility_score": 60.0, "error_recovery_score": 30.0, "detailed_notes": ["+ 2 configurable parameters found", "+ 1 configurable parameters found", "+ 1 configurable parameters found", "+ 8 configurable parameters found", "+ Environment variable usage found", "+ Proper path handling methods used", "- Hardcoded paths detected (reduces portability)", "+ PowerShell Core compatibility considered", "+ Extension/plugin architecture found", "+ Alternative output format available", "+ PowerShell pipeline integration", "+ Customizable output formatting", "+ Basic error handling present", "+ Graceful degradation patterns detected"]}, "details": {}}}}, {"llm_name": "llm2", "files": [{"path": "d:\\CodingModel\\ModelCompare\\FirstPassModelCompare\\llm2\\SafeDeleteReport.ps1", "size": 2613, "lines": 60, "content": "# Part of a LLM test. This one against GPT-4.1\n#First prompt:\n#Create for me a script that can run on windows that identifies files that are safe to delete. \n#It doesn't delete them itself, but provides a ranking of safety. In the report, include the safety-score, \n#parameters that went into the score consideration, file name, size, date created, and date updated. \n#\n# SafeDeleteReport.ps1\n# Scans a directory and ranks files by safety for deletion (does not delete files)\n# Usage: .\\SafeDeleteReport.ps1 -Path \"C:\\Path\\To\\Scan\" -ReportFile \"C:\\Path\\To\\Report.csv\"\n\nparam(\n    [string]$Path = '.',\n    [string]$ReportFile = 'SafeDeleteReport.csv'\n)\n\nfunction Get-SafetyScore {\n    param(\n        [System.IO.FileInfo]$File\n    )\n    $now = Get-Date\n    $ageDays = ($now - $File.CreationTime).TotalDays\n    $lastModDays = ($now - $File.LastWriteTime).TotalDays\n    $sizeMB = [math]::Round($File.Length / 1MB, 2)\n    $ext = $File.Extension.ToLower()\n    $isTemp = $ext -in @('.tmp', '.temp', '.bak', '.log', '.old')\n    $isSystem = $File.Attributes -band [System.IO.FileAttributes]::System\n    $isReadOnly = $File.IsReadOnly\n\n    # Scoring\n    $score = 0\n    $params = @()\n    if ($isTemp) { $score += 40; $params += 'TempExt' }\n    if ($ageDays -gt 180) { $score += 20; $params += 'OldFile' }\n    elseif ($ageDays -gt 90) { $score += 10; $params += 'ModeratelyOld' }\n    if ($lastModDays -gt 180) { $score += 20; $params += 'NotModifiedLong' }\n    elseif ($lastModDays -gt 90) { $score += 10; $params += 'NotModifiedModerate' }\n    if ($sizeMB -gt 100) { $score += 5; $params += 'LargeFile' }\n    if ($isSystem) { $score -= 50; $params += 'SystemFile' }\n    if ($isReadOnly) { $score -= 10; $params += 'ReadOnly' }\n    if ($File.Name -match 'backup|copy|old|temp|log') { $score += 10; $params += 'NamePattern' }\n    if ($score -gt 100) { $score = 100 }\n    if ($score -lt 0) { $score = 0 }\n    return @{ Score = $score; Params = ($params -join ',') }\n}\n\n$files = Get-ChildItem -Path $Path -File -Recurse -ErrorAction SilentlyContinue\n$report = @()\nforeach ($file in $files) {\n    $result = Get-SafetyScore -File $file\n    $report += [PSCustomObject]@{\n        SafetyScore = $result.Score\n        Parameters = $result.Params\n        FileName = $file.FullName\n        SizeMB = [math]::Round($file.Length / 1MB, 2)\n        DateCreated = $file.CreationTime\n        DateUpdated = $file.LastWriteTime\n    }\n}\n$report | Sort-Object -Property SafetyScore -Descending | Export-Csv -Path $ReportFile -NoTypeInformation\nWrite-Host \"Report generated: $ReportFile\"\n"}], "analysis_scores": {"Performance Analysis": {"score": 55, "max_score": 100.0, "notes": ["+ Uses ErrorAction SilentlyContinue (prevents performance hits from errors)", "+ Uses -File parameter for efficient enumeration", "+ Supports recursive scanning", "- String operations in loops may impact performance"], "details": {"total_lines": 60, "has_error_action": true, "uses_file_parameter": true, "supports_recursion": true, "string_ops_in_loops": true, "algorithmic_complexity": "O(n)"}}, "Readability Analysis": {"score": 93, "max_score": 100.0, "notes": ["Excellent commenting (>15% comment ratio)", "Uses descriptive variable names", "Well-organized with 1 functions", "Good logical sectioning with comments", "Good code indentation"], "details": {"comment_ratio": 0.16666666666666666, "comment_lines": 10, "has_help_block": false, "total_variables": 72, "meaningful_variable_ratio": 1.0, "short_variables": [], "function_count": 1, "section_comments": 5, "indentation_ratio": 0.6166666666666667, "mixed_indentation": false}}, "Code Quality Analysis": {"score": 64, "max_score": 100.0, "notes": ["+ Uses ErrorAction for error handling", "+ Uses type hints (2 found)", "+ Well-organized with 1 functions", "+ Consistent code indentation", "+ Uses approved PowerShell verbs", "+ Uses proper parameter block", "+ Reasonable line lengths (<10% over 120 chars)", "+ Good variable naming practices"], "details": {"has_error_action": true, "error_handling_score": 10, "type_hints_count": 2, "has_type_hints": true, "param_validation_score": 4, "function_count": 1, "has_consistent_indentation": true, "organization_score": 10, "uses_approved_verbs": true, "has_param_block": true, "powershell_practices_score": 10, "long_line_ratio": 0.0, "meaningful_variable_ratio": 1.0, "maintainability_score": 10}}, "Documentation Analysis": {"score": 60, "max_score": 100.0, "notes": ["- No README documentation found", "+ Excellent inline commenting (>15% average)", "+ All files have header comments", "+ Good use of section comments", "- No PowerShell help documentation found"], "details": {"readme_count": 0, "has_readme": false, "readme_analysis_score": 0, "average_comment_density": 0.16666666666666666, "files_with_headers": 1, "section_comments": 8, "inline_analysis_score": 30, "files_with_help": 0, "comprehensive_help_files": 0, "total_ps1_files": 1, "help_coverage": 0.0, "help_analysis_score": 0}}, "Requirements Traceability Analysis": {"score": 98.9, "max_score": ["Requirements Implementation: 10/10 (100.0%)", "Mandatory Requirements: 10/10 (100.0%)", "\u2713 All mandatory requirements implemented", "\u2713 Excellent implementation quality", "", "\ud83d\udcca SCORING METHODOLOGY INSIGHTS:", "\u2022 Requirements compliance (binary pass/fail) \u2260 implementation quality (0-100)", "\u2022 Quality scores based on evidence count + implementation depth", "\u2022 Higher evidence count = stronger confidence in requirement fulfillment", "\u2022 Even 'PASS' requirements can vary in quality (94-100% range observed)", "\u2022 Comprehensive implementations score higher than minimal implementations", "\u2022 Example: REQ-006 parameter tracking - detailed vs simple approaches affect scoring"], "notes": {"requirements_total": 10, "requirements_implemented": 10, "mandatory_requirements": 10, "mandatory_implemented": 10, "traceability_matrix": {"requirements": {"REQ-001": {"text": "Script must run on Windows platform", "type": "platform", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 2, "status": "\u2713 PASS"}, "REQ-002": {"text": "Must identify files that are safe to delete", "type": "functionality", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-003": {"text": "Must NOT actually delete files (identification only)", "type": "safety", "mandatory": true, "implemented": true, "quality_score": 95, "evidence_count": 2, "status": "\u2713 PASS"}, "REQ-004": {"text": "Must provide ranking/scoring of safety level", "type": "functionality", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 5, "status": "\u2713 PASS"}, "REQ-005": {"text": "Report must include safety-score field", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 3, "status": "\u2713 PASS"}, "REQ-006": {"text": "Report must include parameters that went into score consideration", "type": "output", "mandatory": true, "implemented": true, "quality_score": 94, "evidence_count": 1, "status": "\u2713 PASS"}, "REQ-007": {"text": "Report must include file name", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-008": {"text": "Report must include file size", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-009": {"text": "Report must include date created", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-010": {"text": "Report must include date updated/modified", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}}, "summary": {"total_requirements": 10, "implemented": 10, "not_implemented": 0, "mandatory_met": 10, "optional_met": 0}}, "requirement_traces": [{"id": "REQ-001", "text": "Script must run on Windows platform", "implemented": true, "quality": 100, "evidence_count": 2}, {"id": "REQ-002", "text": "Must identify files that are safe to delete", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-003", "text": "Must NOT actually delete files (identification only)", "implemented": true, "quality": 95, "evidence_count": 2}, {"id": "REQ-004", "text": "Must provide ranking/scoring of safety level", "implemented": true, "quality": 100, "evidence_count": 5}, {"id": "REQ-005", "text": "Report must include safety-score field", "implemented": true, "quality": 100, "evidence_count": 3}, {"id": "REQ-006", "text": "Report must include parameters that went into score consideration", "implemented": true, "quality": 94, "evidence_count": 1}, {"id": "REQ-007", "text": "Report must include file name", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-008", "text": "Report must include file size", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-009", "text": "Report must include date created", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-010", "text": "Report must include date updated/modified", "implemented": true, "quality": 100, "evidence_count": 4}]}, "details": {}}, "Security Analysis": {"score": 94.0, "max_score": ["\u2713 No critical security vulnerabilities detected", "\u2713 No high-risk security issues detected", "\u26a1 3 MEDIUM risk security issues found", "\u274c No security best practices detected", "- MEDIUM: Input Validation (2 instances)", "- MEDIUM: Error Handling (1 instances)"], "notes": {"security_issues": {"MEDIUM_input_validation": ["param(\n    [string]$Path = '.',\n    [string]$ReportFile = 'SafeDeleteReport.csv'\n)\n\n", "param(\n        [System.IO.FileInfo]$File\n    )\n    "], "MEDIUM_error_handling": ["-ErrorAction SilentlyContinue"]}, "good_practices": {}, "files_analyzed": 1, "total_content_length": 2554, "security_score_breakdown": {"critical_issues": 0, "high_risk_issues": 0, "medium_risk_issues": 3, "good_practices_count": 0, "security_categories_analyzed": 11, "practice_categories_found": 0}}, "details": {}}, "Adaptability Analysis": {"score": 27.5, "max_score": ["Configuration Flexibility: 50.0/100", "Cross-Platform Compatibility: 0.0/100", "Extensibility: 40.0/100", "Environment Adaptation: 0.0/100", "Input/Output Flexibility: 40.0/100", "Error Recovery: 30.0/100", "\u274c Limited configuration options", "\u274c Platform-specific limitations", "\u274c Limited extensibility"], "notes": {"configuration_score": 50.0, "cross_platform_score": 0.0, "extensibility_score": 40.0, "environment_adaptation_score": 0.0, "input_output_flexibility_score": 40.0, "error_recovery_score": 30.0, "detailed_notes": ["+ 2 configurable parameters found", "+ 12 configurable parameters found", "- Hardcoded paths detected (reduces portability)", "+ PowerShell Core compatibility considered", "+ Some modularity with 1 function(s)", "+ Extension/plugin architecture found", "+ Alternative output format available", "+ PowerShell pipeline integration", "+ Basic error handling present", "+ Graceful degradation patterns detected"]}, "details": {}}}}, {"llm_name": "llm3", "files": [{"path": "d:\\CodingModel\\ModelCompare\\FirstPassModelCompare\\llm3\\README_FileDeletionSafetyReport.md", "size": 3144, "lines": 68, "content": "# A comparison of LLM coding models. \nThis one is for GPT5.  Each one starts with a single prompt: \n\nCreate for me a script that can run on windows that identifies files that are safe to delete. It doesn't delete them itself, but provides a ranking of safety. In the report, include the safety-score, parameters that went into the score consideration, file name, size, date created, and date updated. \n\n\n\n# File Deletion Safety Report Script\n\nA PowerShell script that ranks files by an estimated \"safety\" of deletion (0-100). It NEVER deletes anything; it only reports scores with factor breakdowns so you can make informed manual decisions.\n\n## Features\n- Multi-factor scoring: age, last access, extension type, temp/log directory hints, redundancy of similarly named files, size, and attribute penalties.\n- Adjustable weights for each factor via parameters.\n- Supports optional recursion.\n- Export to CSV, JSON, and/or Markdown.\n- Human-readable size column + raw byte length.\n\n## Usage\nFrom a PowerShell prompt in the repository root:\n\n```powershell\n# Basic (current directory, top 100)\n./scripts/FileDeletionSafetyReport.ps1\n\n# Recurse through a path and export CSV + JSON\n./scripts/FileDeletionSafetyReport.ps1 -Path C:\\Some\\Folder -Recurse -OutCsv report.csv -OutJson report.json\n\n# Show top 300 candidates\n./scripts/FileDeletionSafetyReport.ps1 -Top 300\n\n# Scan temp folder with custom weights\n./scripts/FileDeletionSafetyReport.ps1 -Path $env:TEMP -Recurse -WAge 40 -WExtension 25 -WRedundancy 10\n\n# Include Markdown summary\n./scripts/FileDeletionSafetyReport.ps1 -Path $env:TEMP -OutMarkdown temp_report.md\n```\n\n## Parameters (Key)\n- Path: Root directory (default: '.')\n- Recurse: Include subdirectories.\n- Top: Number of top-scoring files to display (default: 200)\n- MinSizeBytes: Ignore files smaller than this.\n- Weight parameters: WAge, WAccessAge, WTempLocation, WExtension, WRedundancy, WAttributesPenalty, WRecentWritePenalty, WRecentCreatePenalty, WSizeBonus.\n- OutCsv / OutJson / OutMarkdown: Export paths.\n\n## Interpreting Scores\n- 80-100: Likely disposable (old logs/temp/backups); still verify no active process uses them.\n- 60-79: Possibly safe; inspect manually.\n- 40-59: Mixed signals; caution.\n- <40: Probably important or recently used.\n\nInspect the Factors column (CSV/JSON) for the rationale. Example: `AgeFactor=1.00;AccessAgeFactor=1.00;ExtFactor=1.00;TempDirFactor=1;RedundancyFactor=0.44(count=5);SizeBonusFactor=0.12;RecentWritePenaltyFactor=0.00;RecentCreatePenaltyFactor=0.00;AttrPenaltyFactor=0.00`\n\n## Safety Notes\n- Always keep backups before deleting.\n- Do not rely solely on file extension; verify context.\n- System / program directories (Windows, Program Files, System32) should generally not be targeted.\n- Consider testing deletions by moving files to a quarantine folder first.\n\n## Customizing Logic\nEdit `FileDeletionSafetyReport.ps1` to adjust:\n- Extension lists `$safeExt`, `$riskyExt`.\n- Temp directory tokens `$tempDirTokens`.\n- Scoring math for your environment.\n\n## License\nProvided as-is, no warranty. Use at your own risk.\n"}, {"path": "d:\\CodingModel\\ModelCompare\\FirstPassModelCompare\\llm3\\scripts\\FileDeletionSafetyReport.ps1", "size": 9575, "lines": 230, "content": "<#!\n.SYNOPSIS\nGenerates a ranked report of files that may be safe to delete.\n\n.DESCRIPTION\nAnalyzes files under a target path (default: current directory) and computes a safety score (0-100) estimating how \"safe\" it is to delete each file.\nThe script DOES NOT delete anything. It only reports.\n\nScore Factors (weights are adjustable via parameters):\n- Age since last write (older -> safer)\n- Last access time (older -> safer)\n- Redundancy by name pattern (e.g., many sequentially numbered backups -> safer)\n- Located in common temp/cache directory names (temp, cache, logs, tmp) (safer)\n- File extension type (e.g., .tmp, .log, .bak, .old -> safer; .exe, .dll, .sys -> risky)\n- Size (very large & old/log/tmp may increase safety slightly)\n- Recently created or modified files penalized\n- System / hidden / read-only attributes penalized\n- Very small random files (<1KB) with temp-like names slightly safer\n\nOutput: A CSV / JSON / table with: SafetyScore, ContributingFactors, FilePath, Name, Extension, Length (bytes), SizeHuman, Created, LastWrite, LastAccess, Attributes.\n\n.EXAMPLE\n# Basic usage in current directory\n./FileDeletionSafetyReport.ps1 -Path . -Top 100 -OutCsv report.csv\n\n.EXAMPLE\n# Scan user temp directory and export JSON\n./FileDeletionSafetyReport.ps1 -Path $env:TEMP -OutJson temp_safety.json\n\n.NOTES\nAdjust weight parameters to tune scoring. Always manually review before deleting.\n#>\n[CmdletBinding()] Param(\n    [Parameter(Position=0)]\n    [string] $Path = '.',\n\n    [int] $Top = 200,\n\n    [switch] $Recurse,\n\n    [string] $OutCsv,\n    [string] $OutJson,\n    [string] $OutMarkdown,\n\n    [int] $MinSizeBytes = 0,\n\n    # Weight parameters (0-100). They will be normalized internally.\n    [int] $WAge = 30,\n    [int] $WAccessAge = 10,\n    [int] $WTempLocation = 10,\n    [int] $WExtension = 15,\n    [int] $WRedundancy = 15,\n    [int] $WAttributesPenalty = 10,\n    [int] $WRecentWritePenalty = 10,\n    [int] $WRecentCreatePenalty = 10,\n    [int] $WSizeBonus = 5\n)\n\nSet-StrictMode -Version Latest\n$ErrorActionPreference = 'Stop'\n\nif (-not (Test-Path -LiteralPath $Path)) {\n    throw \"Path not found: $Path\"\n}\n\n$now = Get-Date\n\n# Helper: human readable file size\nfunction Convert-Size {\n    param([long]$Bytes)\n    if ($Bytes -lt 1KB) { return \"$Bytes B\" }\n    elseif ($Bytes -lt 1MB) { return \"{0:N2} KB\" -f ($Bytes/1KB) }\n    elseif ($Bytes -lt 1GB) { return \"{0:N2} MB\" -f ($Bytes/1MB) }\n    elseif ($Bytes -lt 1TB) { return \"{0:N2} GB\" -f ($Bytes/1GB) }\n    else { return \"{0:N2} TB\" -f ($Bytes/1TB) }\n}\n\n# Gather files\n$searchParams = @{ LiteralPath = $Path; File = $true }\nif ($Recurse) { $searchParams['Recurse'] = $true }\n$files = Get-ChildItem @searchParams -ErrorAction SilentlyContinue | Where-Object { -not $_.PSIsContainer -and $_.Length -ge $MinSizeBytes }\n\nif (-not $files) {\n    Write-Warning \"No files found under path $Path (recurse=$Recurse) meeting criteria.\"\n    return\n}\n\n# Precompute name groups for redundancy detection\n$nameStemMap = @{}\nforeach ($f in $files) {\n    $stem = ($f.BaseName -replace '(?i)[-_]?(copy|backup|bak|old|temp|tmp|log|v\\d+)$','')\n    if (-not $nameStemMap.ContainsKey($stem)) { $nameStemMap[$stem] = @() }\n    $nameStemMap[$stem] += $f\n}\n\n# Extensions considered usually safe (older -> safer)\n$safeExt = '.tmp','.temp','.log','.bak','.old','.chk','.dmp','.err','.cache','.msi.old'\n$riskyExt = '.exe','.dll','.sys','.ocx','.drv','.dat','.db','.pst','.xls','.xlsx','.doc','.docx','.pdf'\n\n# Temp-like directory name fragments\n$tempDirTokens = 'temp','tmp','cache','caches','log','logs','crash','minidump','reports','report','backups','bak'\n\n$results = foreach ($f in $files) {\n    $ageDays = ($now - $f.LastWriteTime).TotalDays\n    $createAgeDays = ($now - $f.CreationTime).TotalDays\n    $accessAgeDays = if ($f.PSObject.Properties.Name -contains 'LastAccessTime') { ($now - $f.LastAccessTime).TotalDays } else { $ageDays }\n\n    $scoreBreakdown = @()\n    $score = 0.0\n\n    # Age factor\n    $ageScore = [Math]::Min(1, $ageDays / 180)   # full credit after ~6 months\n    $score += $ageScore * $WAge\n    $scoreBreakdown += \"AgeFactor={0:N2}\" -f $ageScore\n\n    # Access age\n    $accessScore = [Math]::Min(1, $accessAgeDays / 180)\n    $score += $accessScore * $WAccessAge\n    $scoreBreakdown += \"AccessAgeFactor={0:N2}\" -f $accessScore\n\n    # Extension factor\n    $ext = $f.Extension.ToLowerInvariant()\n    $extFactor = if ($safeExt -contains $ext) { 1 } elseif ($riskyExt -contains $ext) { 0 } else { 0.4 }\n    $score += $extFactor * $WExtension\n    $scoreBreakdown += \"ExtFactor={0:N2}\" -f $extFactor\n\n    # Temp-like directory factor\n    $pathLower = $f.FullName.ToLowerInvariant()\n    $dirFactor = if ($tempDirTokens | Where-Object { $pathLower -match \"\\\\$_(\\\\|/|$)\" -or $pathLower -match \"\\\\$_\\\\\" }) { 1 } else { 0 }\n    $score += $dirFactor * $WTempLocation\n    $scoreBreakdown += \"TempDirFactor=$dirFactor\"\n\n    # Redundancy: many similar stems\n    $stem = ($f.BaseName -replace '(?i)[-_]?(copy|backup|bak|old|temp|tmp|log|v\\d+)$','')\n    $groupCount = $nameStemMap[$stem].Count\n    $redundancyFactor = [Math]::Min(1, ($groupCount - 1) / 9) # 10+ similar -> full\n    $score += $redundancyFactor * $WRedundancy\n    $scoreBreakdown += \"RedundancyFactor={0:N2}(count=$groupCount)\" -f $redundancyFactor\n\n    # Size bonus (if large AND old & safe ext / temp dir)\n    $sizeMB = $f.Length / 1MB\n    $sizeBonusFactor = 0\n    if ($sizeMB -ge 100 -and $ageDays -ge 90 -and ($extFactor -ge 0.4) -and ($dirFactor -eq 1 -or $extFactor -eq 1)) {\n        $sizeBonusFactor = [Math]::Min(1, ($sizeMB - 100) / 900) # up to 1000MB\n    }\n    $score += $sizeBonusFactor * $WSizeBonus\n    $scoreBreakdown += \"SizeBonusFactor={0:N2}\" -f $sizeBonusFactor\n\n    # Penalties (subtract)\n    $penalty = 0\n\n    # Recent write penalty\n    $recentWriteFactor = if ($ageDays -lt 7) { 1 } elseif ($ageDays -lt 30) { 0.5 } else { 0 }\n    $penalty += $recentWriteFactor * $WRecentWritePenalty\n    $scoreBreakdown += \"RecentWritePenaltyFactor={0:N2}\" -f $recentWriteFactor\n\n    # Recent create penalty\n    $recentCreateFactor = if ($createAgeDays -lt 7) { 1 } elseif ($createAgeDays -lt 30) { 0.5 } else { 0 }\n    $penalty += $recentCreateFactor * $WRecentCreatePenalty\n    $scoreBreakdown += \"RecentCreatePenaltyFactor={0:N2}\" -f $recentCreateFactor\n\n    # Attribute penalty\n    $attrPenaltyFactor = 0\n    if ($f.Attributes.ToString().Contains('System')) { $attrPenaltyFactor += 0.7 }\n    if ($f.Attributes.ToString().Contains('Hidden')) { $attrPenaltyFactor += 0.2 }\n    if ($f.Attributes.ToString().Contains('ReadOnly')) { $attrPenaltyFactor += 0.2 }\n    if ($ext -eq '.dll' -or $ext -eq '.sys') { $attrPenaltyFactor += 0.5 }\n    $attrPenaltyFactor = [Math]::Min(1, $attrPenaltyFactor)\n    $penalty += $attrPenaltyFactor * $WAttributesPenalty\n    $scoreBreakdown += \"AttrPenaltyFactor={0:N2}\" -f $attrPenaltyFactor\n\n    $score -= $penalty\n\n    # Normalize to 0-100\n    $maxPositive = ($WAge + $WAccessAge + $WTempLocation + $WExtension + $WRedundancy + $WSizeBonus)\n    $maxNegative = ($WRecentWritePenalty + $WRecentCreatePenalty + $WAttributesPenalty)\n    $rawMin = -$maxNegative\n    $rawMax = $maxPositive\n    $normScore = if ($rawMax - $rawMin -ne 0) { (($score - $rawMin) / ($rawMax - $rawMin)) * 100 } else { 0 }\n    if ($normScore -lt 0) { $normScore = 0 }\n    if ($normScore -gt 100) { $normScore = 100 }\n\n    [PSCustomObject]@{\n        SafetyScore = [Math]::Round($normScore,2)\n        Factors      = ($scoreBreakdown -join ';')\n        FilePath     = $f.FullName\n        Name         = $f.Name\n        Extension    = $ext\n        Length       = $f.Length\n        SizeHuman    = Convert-Size $f.Length\n        Created      = $f.CreationTime\n        LastWrite    = $f.LastWriteTime\n        LastAccess   = if ($f.PSObject.Properties.Name -contains 'LastAccessTime') { $f.LastAccessTime } else { $null }\n        Attributes   = $f.Attributes\n    }\n}\n\n$sorted = $results | Sort-Object SafetyScore -Descending | Select-Object -First $Top\n\n# Output table\n$sorted | Format-Table -AutoSize SafetyScore, SizeHuman, LastWrite, Name, FilePath\n\nif ($OutCsv) {\n    $sorted | Export-Csv -NoTypeInformation -Encoding UTF8 -Path $OutCsv\n    Write-Host \"CSV written: $OutCsv\" -ForegroundColor Green\n}\nif ($OutJson) {\n    $sorted | ConvertTo-Json -Depth 4 | Set-Content -Encoding UTF8 -Path $OutJson\n    Write-Host \"JSON written: $OutJson\" -ForegroundColor Green\n}\nif ($OutMarkdown) {\n    $md = @()\n    $md += \"# File Deletion Safety Report\"\n    $md += \"Generated: $(Get-Date -Format o)\"\n    $md += \"Scanned Path: $(Resolve-Path $Path)  Recurse=$Recurse  FilesConsidered=$($results.Count)  ShowingTop=$Top\"\n    $md += ''\n    $md += \"| Score | Size | LastWrite | Name | Path |\"\n    $md += \"|------:|------:|-----------|------|------|\"\n    foreach ($r in $sorted) {\n        $md += \"| $($r.SafetyScore) | $($r.SizeHuman) | $($r.LastWrite.ToString('yyyy-MM-dd')) | $($r.Name) | $([System.Web.HttpUtility]::HtmlEncode($r.FilePath)) |\"\n    }\n    $md += ''\n    $md += '## Legend'\n    $md += '* Score nearer 100 = likely safer to delete (still verify).'\n    $md += '* Inspect Factors column in CSV/JSON for rationale.'\n    $md -join \"`n\" | Set-Content -Encoding UTF8 -Path $OutMarkdown\n    Write-Host \"Markdown written: $OutMarkdown\" -ForegroundColor Green\n}\n\nWrite-Host \"Done. Reviewed $($results.Count) files.\" -ForegroundColor Cyan\n"}], "analysis_scores": {"Performance Analysis": {"score": 55, "max_score": 100.0, "notes": ["+ Uses ErrorAction SilentlyContinue (prevents performance hits from errors)", "+ Implements result limiting for memory efficiency", "+ Shows evidence of caching/pre-computation", "- Multiple Where-Object filters (2) after enumeration", "- String operations in loops may impact performance", "+ Good balance of features and performance", "- Contains nested loops (1) - potential O(n\u00b2) complexity"], "details": {"total_lines": 230, "has_error_action": true, "has_result_limiting": true, "has_caching": true, "multiple_where_filters": 2, "string_ops_in_loops": true, "complexity_level": "balanced", "nested_loops": 1, "algorithmic_complexity": "O(n\u00b2)"}}, "Readability Analysis": {"score": 100, "max_score": 100.0, "notes": ["Adequate commenting (>5% comment ratio)", "Includes PowerShell help documentation", "Comprehensive help documentation", "Uses descriptive variable names", "Well-organized with 1 functions", "Good logical sectioning with comments", "Good code indentation"], "details": {"comment_ratio": 0.09130434782608696, "comment_lines": 21, "has_help_block": true, "help_sections_count": 4, "total_variables": 257, "meaningful_variable_ratio": 0.9260700389105059, "short_variables": ["md", "md", "md", "md", "md", "md", "md", "r", "md", "r", "r", "r", "r", "r", "md", "md", "md", "md", "md"], "function_count": 1, "section_comments": 21, "indentation_ratio": 0.5565217391304348, "mixed_indentation": false}}, "Code Quality Analysis": {"score": 78, "max_score": 100.0, "notes": ["+ Uses ErrorAction for error handling", "+ Uses Parameter attributes", "+ Uses type hints (16 found)", "+ Well-organized with 1 functions", "+ Consistent code indentation", "+ Uses CmdletBinding for advanced functions", "+ Uses proper parameter block", "+ Reasonable line lengths (<10% over 120 chars)", "+ Good variable naming practices"], "details": {"has_error_action": true, "error_handling_score": 10, "has_parameter_attributes": true, "type_hints_count": 16, "has_type_hints": true, "param_validation_score": 18, "function_count": 1, "has_consistent_indentation": true, "organization_score": 10, "has_cmdletbinding": true, "has_param_block": true, "powershell_practices_score": 10, "long_line_ratio": 0.02608695652173913, "meaningful_variable_ratio": 0.9260700389105059, "maintainability_score": 10}}, "Documentation Analysis": {"score": 100, "max_score": 100.0, "notes": ["+ Includes README documentation", "+ README contains: usage, examples, features, parameters", "+ README includes code examples", "+ Comprehensive README documentation", "+ Adequate inline commenting (>5% average)", "+ Good use of section comments", "+ All PowerShell files have help documentation", "+ 1 files have comprehensive help (4+ sections)"], "details": {"readme_count": 1, "readme_sections_found": ["usage", "examples", "features", "parameters"], "has_code_examples": true, "comprehensive_readme": true, "readme_analysis_score": 40, "average_comment_density": 0.09130434782608696, "files_with_headers": 0, "section_comments": 20, "inline_analysis_score": 10, "files_with_help": 1, "comprehensive_help_files": 1, "total_ps1_files": 1, "help_coverage": 1.0, "help_analysis_score": 30}}, "Requirements Traceability Analysis": {"score": 99.5, "max_score": ["Requirements Implementation: 10/10 (100.0%)", "Mandatory Requirements: 10/10 (100.0%)", "\u2713 All mandatory requirements implemented", "\u2713 Excellent implementation quality", "", "\ud83d\udcca SCORING METHODOLOGY INSIGHTS:", "\u2022 Requirements compliance (binary pass/fail) \u2260 implementation quality (0-100)", "\u2022 Quality scores based on evidence count + implementation depth", "\u2022 Higher evidence count = stronger confidence in requirement fulfillment", "\u2022 Even 'PASS' requirements can vary in quality (94-100% range observed)", "\u2022 Comprehensive implementations score higher than minimal implementations", "\u2022 Example: REQ-006 parameter tracking - detailed vs simple approaches affect scoring"], "notes": {"requirements_total": 10, "requirements_implemented": 10, "mandatory_requirements": 10, "mandatory_implemented": 10, "traceability_matrix": {"requirements": {"REQ-001": {"text": "Script must run on Windows platform", "type": "platform", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-002": {"text": "Must identify files that are safe to delete", "type": "functionality", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-003": {"text": "Must NOT actually delete files (identification only)", "type": "safety", "mandatory": true, "implemented": true, "quality_score": 95, "evidence_count": 2, "status": "\u2713 PASS"}, "REQ-004": {"text": "Must provide ranking/scoring of safety level", "type": "functionality", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 5, "status": "\u2713 PASS"}, "REQ-005": {"text": "Report must include safety-score field", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 3, "status": "\u2713 PASS"}, "REQ-006": {"text": "Report must include parameters that went into score consideration", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 3, "status": "\u2713 PASS"}, "REQ-007": {"text": "Report must include file name", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 3, "status": "\u2713 PASS"}, "REQ-008": {"text": "Report must include file size", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-009": {"text": "Report must include date created", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-010": {"text": "Report must include date updated/modified", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}}, "summary": {"total_requirements": 10, "implemented": 10, "not_implemented": 0, "mandatory_met": 10, "optional_met": 0}}, "requirement_traces": [{"id": "REQ-001", "text": "Script must run on Windows platform", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-002", "text": "Must identify files that are safe to delete", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-003", "text": "Must NOT actually delete files (identification only)", "implemented": true, "quality": 95, "evidence_count": 2}, {"id": "REQ-004", "text": "Must provide ranking/scoring of safety level", "implemented": true, "quality": 100, "evidence_count": 5}, {"id": "REQ-005", "text": "Report must include safety-score field", "implemented": true, "quality": 100, "evidence_count": 3}, {"id": "REQ-006", "text": "Report must include parameters that went into score consideration", "implemented": true, "quality": 100, "evidence_count": 3}, {"id": "REQ-007", "text": "Report must include file name", "implemented": true, "quality": 100, "evidence_count": 3}, {"id": "REQ-008", "text": "Report must include file size", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-009", "text": "Report must include date created", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-010", "text": "Report must include date updated/modified", "implemented": true, "quality": 100, "evidence_count": 4}]}, "details": {}}, "Security Analysis": {"score": 100, "max_score": ["\u2713 No critical security vulnerabilities detected", "\u2713 No high-risk security issues detected", "\u26a1 3 MEDIUM risk security issues found", "\u26aa Some security practices found (4 detected)", "- MEDIUM: Input Validation (2 instances)", "- MEDIUM: Error Handling (1 instances)", "+ Safe File Operations: 3 instances", "+ Logging Auditing: 1 instances"], "notes": {"security_issues": {"MEDIUM_input_validation": ["Param(\n    [Parameter(Position=0)", "param([long]$Bytes)\n    "], "MEDIUM_error_handling": ["-ErrorAction SilentlyContinue"]}, "good_practices": {"safe_file_operations": ["Test-Path", "-LiteralPath", "Resolve-Path"], "logging_auditing": ["Write-Warning"]}, "files_analyzed": 1, "total_content_length": 9346, "security_score_breakdown": {"critical_issues": 0, "high_risk_issues": 0, "medium_risk_issues": 3, "good_practices_count": 4, "security_categories_analyzed": 11, "practice_categories_found": 2}}, "details": {}}, "Adaptability Analysis": {"score": 31.8, "max_score": ["Configuration Flexibility: 65.0/100", "Cross-Platform Compatibility: 20.0/100", "Extensibility: 30.0/100", "Environment Adaptation: 0.0/100", "Input/Output Flexibility: 35.0/100", "Error Recovery: 20.0/100", "\u26a1 Good configuration flexibility", "\u274c Platform-specific limitations", "\u274c Limited extensibility"], "notes": {"configuration_score": 65.0, "cross_platform_score": 20.0, "extensibility_score": 30.0, "environment_adaptation_score": 0.0, "input_output_flexibility_score": 35.0, "error_recovery_score": 20.0, "detailed_notes": ["+ 1 configurable parameters found", "+ 1 configurable parameters found", "+ 2 configurable parameters found", "+ 47 configurable parameters found", "+ Configuration file support detected", "+ Environment variable usage found", "+ Switch parameters for boolean options", "+ Proper path handling methods used", "+ PowerShell Core compatibility considered", "+ Some modularity with 1 function(s)", "+ Extension/plugin architecture found", "+ Data-driven processing patterns detected", "+ Multiple output formats supported (2 types)", "+ PowerShell pipeline integration", "+ Customizable output formatting"]}, "details": {}}}}, {"llm_name": "llm4", "files": [{"path": "d:\\CodingModel\\ModelCompare\\FirstPassModelCompare\\llm4\\create-test-files.bat", "size": 1561, "lines": 51, "content": "@echo off\necho Creating test files for Safe Delete Analyzer demo...\n\nREM Create test directory structure\nmkdir test_files 2>nul\ncd test_files\n\nmkdir temp 2>nul\nmkdir downloads 2>nul\nmkdir documents 2>nul\nmkdir cache 2>nul\n\nREM Create various test files with different characteristics\n\nREM Very safe files (temp, cache, old)\necho This is a temporary file > temp\\temp_file.tmp\necho Cache data > cache\\browser.cache\necho Old backup > backup_2023.bak\necho Download part > downloads\\video.part\n\nREM Safe files (logs, old files)\necho Log entry > system.log\necho Old data > old_data.old\n\nREM Moderate files (media, archives)\necho Image data > photo.jpg\necho Video data > movie.mp4\necho Archive > backup.zip\n\nREM Caution files (documents)\necho Important document > documents\\report.docx\necho Spreadsheet data > documents\\budget.xlsx\n\nREM Unsafe files (executables, system)\necho Executable > program.exe\necho System file > system.dll\n\nREM Create files with different timestamps using PowerShell\npowershell.exe -Command \"Get-ChildItem *.bak | ForEach-Object { $_.CreationTime = (Get-Date).AddDays(-400); $_.LastWriteTime = (Get-Date).AddDays(-400) }\"\npowershell.exe -Command \"Get-ChildItem *.log | ForEach-Object { $_.LastWriteTime = (Get-Date).AddDays(-100) }\"\n\necho.\necho Test files created in 'test_files' directory!\necho You can now run the analyzer on this directory:\necho.\necho   .\\Safe-Delete-Analyzer.ps1 -Path \"%CD%\"\necho.\necho Or use the batch file and specify this path when prompted:\necho   %CD%\necho.\npause\n"}, {"path": "d:\\CodingModel\\ModelCompare\\FirstPassModelCompare\\llm4\\README.md", "size": 7077, "lines": 192, "content": "# Safe Delete Analyzer\n\nA Windows PowerShell script that analyzes files and provides safety rankings for potential deletion. The script doesn't delete any files but generates a comprehensive report to help you identify which files are safe to remove.\n\n## Features\n\n- **Safety Scoring System**: Files are scored from 0-100 based on multiple factors\n- **Comprehensive Analysis**: Considers file type, age, location, size, and usage patterns\n- **Detailed Reporting**: CSV output with safety scores, contributing factors, and file metadata\n- **Flexible Configuration**: Customizable parameters for different analysis needs\n- **System Protection**: Optional exclusion of system directories and files\n\n## Safety Score Ranges\n\n- **90-100: Very Safe** - Temporary files, browser cache, duplicates, old downloads\n- **70-89: Safe** - Old cache files, log files, backup files\n- **50-69: Moderate** - Old backups, old media files, archived documents\n- **30-49: Caution** - Important documents, recent files, user data\n- **0-29: Unsafe** - System files, executables, recently modified files\n\n## Files Included\n\n1. **Safe-Delete-Analyzer.ps1** - Main PowerShell script\n2. **run-analyzer.bat** - Simple batch file wrapper for easy execution\n3. **README.md** - This documentation file\n\n## Quick Start\n\n### Option 1: Using the Batch File (Easiest)\n1. Double-click `run-analyzer.bat`\n2. Follow the prompts to specify:\n   - Path to analyze (or press Enter for current directory)\n   - Minimum file size in KB\n   - Whether to exclude system directories\n3. The script will run and generate a report\n\n### Option 2: Using PowerShell Directly\n\n#### Basic Usage\n```powershell\n.\\Safe-Delete-Analyzer.ps1\n```\n\n#### Analyze Specific Directory\n```powershell\n.\\Safe-Delete-Analyzer.ps1 -Path \"C:\\Users\\Username\\Downloads\"\n```\n\n#### Multiple Directories\n```powershell\n.\\Safe-Delete-Analyzer.ps1 -Path @(\"C:\\Temp\", \"C:\\Users\\Username\\Desktop\", \"C:\\Users\\Username\\Downloads\")\n```\n\n#### With Custom Parameters\n```powershell\n.\\Safe-Delete-Analyzer.ps1 -Path \"C:\\Users\\Username\" -MinSizeKB 100 -ExcludeSystem -MaxDepth 3\n```\n\n## Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| `Path` | String[] | Current directory | Path(s) to analyze |\n| `MinSizeKB` | Integer | 1 | Minimum file size in KB to include |\n| `ExcludeSystem` | Switch | False | Exclude system directories and files |\n| `OutputPath` | String | Auto-generated | Custom path for CSV report |\n| `MaxDepth` | Integer | Unlimited | Maximum directory depth to scan |\n\n## Safety Scoring Factors\n\nThe script evaluates files based on these criteria:\n\n### File Extension Categories\n- **Very High Risk**: `.exe`, `.dll`, `.sys`, `.bat`, `.cmd`, `.ps1`, `.vbs`, `.com`, `.scr`, `.msi`, `.reg`\n- **High Risk**: `.docx`, `.xlsx`, `.pptx`, `.pdf`, `.txt`, `.doc`, `.xls`, `.ppt`\n- **Moderate Risk**: `.jpg`, `.png`, `.mp4`, `.mp3`, `.avi`, `.mov`, `.zip`, `.rar`, `.7z`\n- **Low Risk**: `.log`, `.bak`, `.old`, `.cache`, `.tmp`\n- **Very Low Risk**: `.temp`, `.~tmp`, `.crdownload`, `.part`, `.partial`\n\n### Age Analysis\n- Files not modified in over a year: +15 points\n- Files not modified in 6+ months: +10 points\n- Files not modified in 1+ month: +5 points\n- Files modified within a week: -10 points\n\n### Location Analysis\n- Temp directories (Downloads, Temp, Cache): +20 points\n- System directories (Windows, Program Files): -30 points\n\n### Special Patterns\n- Backup/temp filename patterns: +15 points\n- Duplicate files (numbered copies): +10 points\n- Browser cache files: +25 points\n- Zero-byte files: +20 points\n- Large files (>100MB): +10 points\n\n## Output Report\n\nThe CSV report includes the following columns:\n\n- **SafetyScore**: Numerical score (0-100)\n- **SafetyLevel**: Text classification (Very Safe, Safe, Moderate, Caution, Unsafe)\n- **FileName**: Name of the file\n- **FullPath**: Complete file path\n- **SizeKB**: File size in kilobytes\n- **SizeMB**: File size in megabytes\n- **DateCreated**: File creation timestamp\n- **DateModified**: Last modification timestamp\n- **DateAccessed**: Last access timestamp\n- **Extension**: File extension\n- **Directory**: Parent directory path\n- **SafetyFactors**: Detailed explanation of scoring factors\n\n## Example Output\n\n```\nSafetyScore SafetyLevel FileName              SizeMB DateModified\n----------- ----------- --------              ------ ------------\n98          Very Safe   temp_download.tmp     15.2   2023-01-15\n95          Very Safe   cache_file.cache      2.1    2023-02-20\n87          Safe        old_backup.bak        156.7  2023-03-10\n72          Safe        system.log            0.8    2023-06-15\n45          Caution     document.docx         0.5    2024-08-01\n15          Unsafe      important.exe         12.3   2024-08-10\n```\n\n## Safety Recommendations\n\n### Very Safe Files (90-100)\n- Review the list and consider deleting these files\n- Usually temporary files, cache, or obvious duplicates\n- Low risk of causing issues\n\n### Safe Files (70-89)\n- Good candidates for deletion\n- Check if any are needed for specific purposes\n- Generally old files that haven't been accessed recently\n\n### Moderate Files (50-69)\n- Review carefully before deleting\n- May include old but potentially useful files\n- Consider archiving instead of deleting\n\n### Caution Files (30-49)\n- Think twice before deleting\n- Often contain important user data\n- Consider backing up before deletion\n\n### Unsafe Files (0-29)\n- Do NOT delete without expert knowledge\n- Usually system files or important executables\n- Deletion could cause system instability\n\n## System Requirements\n\n- Windows 7 or later\n- PowerShell 5.1 or later (included in Windows 10+)\n- Administrator privileges may be required for some system directories\n\n## Security Notes\n\n- The script only reads file metadata and never modifies or deletes files\n- Use `ExcludeSystem` parameter to avoid analyzing sensitive system areas\n- Always review the report before taking any deletion actions\n- Test with small directories first to understand the scoring system\n\n## Troubleshooting\n\n### \"Execution Policy\" Error\nIf you get an execution policy error, run this command in PowerShell as Administrator:\n```powershell\nSet-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser\n```\n\n### \"Access Denied\" Errors\n- Run PowerShell as Administrator for system directories\n- Use the `-ExcludeSystem` parameter to skip protected areas\n- Some files may be locked by running processes\n\n### Large Directory Analysis\nFor very large directories:\n- Use `-MaxDepth` parameter to limit recursion\n- Increase `-MinSizeKB` to focus on larger files\n- Consider analyzing subdirectories separately\n\n## License\n\nThis script is provided as-is for educational and utility purposes. Use at your own risk and always backup important data before deletion.\n\n## Version History\n\n- **v1.0** - Initial release with comprehensive safety scoring system\n"}, {"path": "d:\\CodingModel\\ModelCompare\\FirstPassModelCompare\\llm4\\run-analyzer.bat", "size": 1577, "lines": 51, "content": "@echo off\nsetlocal enabledelayedexpansion\n\nREM Safe Delete Analyzer - Batch Version\nREM This script provides a simplified version that calls the PowerShell script\n\necho =========================================\necho Safe Delete Analyzer - Windows Edition\necho =========================================\necho.\n\nREM Check if PowerShell script exists\nif not exist \"%~dp0Safe-Delete-Analyzer.ps1\" (\n    echo ERROR: PowerShell script not found!\n    echo Please ensure Safe-Delete-Analyzer.ps1 is in the same directory.\n    pause\n    exit /b 1\n)\n\nREM Get user input for path to analyze\nset /p \"TARGET_PATH=Enter path to analyze (or press Enter for current directory): \"\nif \"%TARGET_PATH%\"==\"\" set \"TARGET_PATH=%CD%\"\n\nREM Get minimum file size\nset /p \"MIN_SIZE=Enter minimum file size in KB (or press Enter for 1KB): \"\nif \"%MIN_SIZE%\"==\"\" set \"MIN_SIZE=1\"\n\nREM Ask about excluding system directories\nset /p \"EXCLUDE_SYSTEM=Exclude system directories? (y/n, default=y): \"\nif \"%EXCLUDE_SYSTEM%\"==\"\" set \"EXCLUDE_SYSTEM=y\"\n\necho.\necho Starting analysis...\necho Target Path: %TARGET_PATH%\necho Minimum Size: %MIN_SIZE% KB\necho Exclude System: %EXCLUDE_SYSTEM%\necho.\n\nREM Build PowerShell command\nset \"PS_COMMAND=& '%~dp0Safe-Delete-Analyzer.ps1' -Path '%TARGET_PATH%' -MinSizeKB %MIN_SIZE%\"\n\nif /i \"%EXCLUDE_SYSTEM%\"==\"y\" (\n    set \"PS_COMMAND=!PS_COMMAND! -ExcludeSystem\"\n)\n\nREM Execute PowerShell script\npowershell.exe -ExecutionPolicy Bypass -Command \"!PS_COMMAND!\"\n\necho.\necho Analysis complete! Check the generated CSV report.\npause\n"}, {"path": "d:\\CodingModel\\ModelCompare\\FirstPassModelCompare\\llm4\\Safe-Delete-Analyzer.ps1", "size": 11832, "lines": 361, "content": "#Requires -Version 5.1\n<#\n.SYNOPSIS\n    Analyzes files and provides safety rankings for potential deletion.\n\n.DESCRIPTION\n    This script scans specified directories and analyzes files to determine how safe they are to delete.\n    It generates a comprehensive report with safety scores, contributing factors, and file metadata.\n\n.PARAMETER Path\n    The path(s) to analyze. Defaults to current directory.\n\n.PARAMETER MinSizeKB\n    Minimum file size in KB to include in analysis. Defaults to 1KB.\n\n.PARAMETER ExcludeSystem\n    Exclude system directories and files from analysis.\n\n.PARAMETER OutputPath\n    Path for the output CSV report. Defaults to current directory.\n\n.PARAMETER MaxDepth\n    Maximum directory depth to scan. Defaults to unlimited.\n\n.EXAMPLE\n    .\\Safe-Delete-Analyzer.ps1 -Path \"C:\\Users\\Username\\Downloads\" -ExcludeSystem\n    \n.EXAMPLE\n    .\\Safe-Delete-Analyzer.ps1 -Path @(\"C:\\Temp\", \"C:\\Users\\Username\\Desktop\") -MinSizeKB 100\n\n.NOTES\n    Author: GitHub Copilot\n    Version: 1.0\n    Safety Score Ranges:\n    - 90-100: Very Safe (temp files, duplicates, old downloads)\n    - 70-89:  Safe (old cache files, old logs)\n    - 50-69:  Moderate (old backups, old media)\n    - 30-49:  Caution (documents, important files)\n    - 0-29:   Unsafe (system files, executables, recent files)\n#>\n\n[CmdletBinding()]\nparam(\n    [Parameter(ValueFromPipeline = $true)]\n    [string[]]$Path = @((Get-Location).Path),\n    \n    [int]$MinSizeKB = 1,\n    \n    [switch]$ExcludeSystem,\n    \n    [string]$OutputPath = (Join-Path (Get-Location).Path \"SafeDeleteReport_$(Get-Date -Format 'yyyyMMdd_HHmmss').csv\"),\n    \n    [int]$MaxDepth = -1\n)\n\n# Define file safety categories and weights\n$SafetyRules = @{\n    # File extension categories (base scores)\n    'VeryHighRisk' = @{\n        'Extensions' = @('.exe', '.dll', '.sys', '.bat', '.cmd', '.ps1', '.vbs', '.com', '.scr', '.msi', '.reg')\n        'BaseScore' = 5\n    }\n    'HighRisk' = @{\n        'Extensions' = @('.docx', '.xlsx', '.pptx', '.pdf', '.txt', '.doc', '.xls', '.ppt')\n        'BaseScore' = 25\n    }\n    'ModerateRisk' = @{\n        'Extensions' = @('.jpg', '.png', '.mp4', '.mp3', '.avi', '.mov', '.zip', '.rar', '.7z')\n        'BaseScore' = 50\n    }\n    'LowRisk' = @{\n        'Extensions' = @('.log', '.bak', '.old', '.cache', '.tmp')\n        'BaseScore' = 75\n    }\n    'VeryLowRisk' = @{\n        'Extensions' = @('.temp', '.~tmp', '.crdownload', '.part', '.partial')\n        'BaseScore' = 95\n    }\n}\n\n# System directories to exclude\n$SystemDirectories = @(\n    'Windows', 'Program Files', 'Program Files (x86)', 'ProgramData',\n    'System Volume Information', '$Recycle.Bin', 'Recovery'\n)\n\n# Temp directories (higher safety scores)\n$TempDirectories = @(\n    'Temp', 'Temporary Internet Files', 'Downloads', 'Recent', 'Prefetch'\n)\n\nfunction Get-FileSafetyScore {\n    param(\n        [System.IO.FileInfo]$File\n    )\n    \n    $score = 50  # Base score\n    $factors = @()\n    \n    # File extension analysis\n    $extension = $File.Extension.ToLower()\n    $categoryFound = $false\n    \n    foreach ($category in $SafetyRules.Keys) {\n        if ($SafetyRules[$category].Extensions -contains $extension) {\n            $score = $SafetyRules[$category].BaseScore\n            $factors += \"Extension category: $category\"\n            $categoryFound = $true\n            break\n        }\n    }\n    \n    if (-not $categoryFound) {\n        $factors += \"Extension: Unknown category\"\n    }\n    \n    # Age analysis\n    $daysSinceCreated = (Get-Date) - $File.CreationTime\n    $daysSinceModified = (Get-Date) - $File.LastWriteTime\n    $daysSinceAccessed = (Get-Date) - $File.LastAccessTime\n    \n    # Older files are generally safer to delete\n    if ($daysSinceModified.Days -gt 365) {\n        $score += 15\n        $factors += \"Very old file (>1 year since modified)\"\n    } elseif ($daysSinceModified.Days -gt 180) {\n        $score += 10\n        $factors += \"Old file (>6 months since modified)\"\n    } elseif ($daysSinceModified.Days -gt 30) {\n        $score += 5\n        $factors += \"Moderately old file (>1 month since modified)\"\n    } elseif ($daysSinceModified.Days -le 7) {\n        $score -= 10\n        $factors += \"Recently modified (within 1 week)\"\n    }\n    \n    # Access time analysis\n    if ($daysSinceAccessed.Days -gt 180) {\n        $score += 10\n        $factors += \"Not accessed recently (>6 months)\"\n    } elseif ($daysSinceAccessed.Days -le 7) {\n        $score -= 5\n        $factors += \"Recently accessed\"\n    }\n    \n    # Size analysis\n    $sizeKB = $File.Length / 1KB\n    if ($sizeKB -gt 100000) {  # > 100MB\n        $score += 10\n        $factors += \"Large file (>100MB)\"\n    } elseif ($sizeKB -lt 1) {  # < 1KB\n        $score += 5\n        $factors += \"Very small file (<1KB)\"\n    }\n    \n    # Directory location analysis\n    $parentDir = $File.Directory.Name\n    \n    # Check if in temp directories\n    foreach ($tempDir in $TempDirectories) {\n        if ($File.FullName -like \"*\\$tempDir\\*\") {\n            $score += 20\n            $factors += \"Located in temp directory: $tempDir\"\n            break\n        }\n    }\n    \n    # Check if in system directories (reduce score)\n    foreach ($sysDir in $SystemDirectories) {\n        if ($File.FullName -like \"*\\$sysDir\\*\") {\n            $score -= 30\n            $factors += \"Located in system directory: $sysDir\"\n            break\n        }\n    }\n    \n    # Special filename patterns\n    if ($File.Name -match '(?i)^(copy|backup|old|temp|~)') {\n        $score += 15\n        $factors += \"Filename suggests temporary/backup file\"\n    }\n    \n    if ($File.Name -match '(?i)\\(\\d+\\)\\.') {\n        $score += 10\n        $factors += \"Appears to be duplicate file (numbered copy)\"\n    }\n    \n    # Browser cache and temp files\n    if ($File.FullName -match '(?i)(cache|cookies|history|temporary)') {\n        $score += 25\n        $factors += \"Browser cache or temporary file\"\n    }\n    \n    # Zero-byte files\n    if ($File.Length -eq 0) {\n        $score += 20\n        $factors += \"Zero-byte file\"\n    }\n    \n    # Ensure score stays within bounds\n    $score = [Math]::Max(0, [Math]::Min(100, $score))\n    \n    return @{\n        'Score' = $score\n        'Factors' = $factors -join '; '\n        'SafetyLevel' = switch ($score) {\n            { $_ -ge 90 } { 'Very Safe' }\n            { $_ -ge 70 } { 'Safe' }\n            { $_ -ge 50 } { 'Moderate' }\n            { $_ -ge 30 } { 'Caution' }\n            default { 'Unsafe' }\n        }\n    }\n}\n\nfunction Get-DirectoryFiles {\n    param(\n        [string]$DirectoryPath,\n        [int]$CurrentDepth = 0\n    )\n    \n    if ($MaxDepth -ge 0 -and $CurrentDepth -gt $MaxDepth) {\n        return\n    }\n    \n    try {\n        $items = Get-ChildItem -Path $DirectoryPath -Force -ErrorAction SilentlyContinue\n        \n        foreach ($item in $items) {\n            if ($item.PSIsContainer) {\n                # Skip system directories if requested\n                if ($ExcludeSystem) {\n                    $skipDir = $false\n                    foreach ($sysDir in $SystemDirectories) {\n                        if ($item.Name -eq $sysDir -or $item.FullName -like \"*\\$sysDir\" -or $item.FullName -like \"*\\$sysDir\\*\") {\n                            $skipDir = $true\n                            break\n                        }\n                    }\n                    if ($skipDir) { continue }\n                }\n                \n                # Recursively process subdirectory\n                Get-DirectoryFiles -DirectoryPath $item.FullName -CurrentDepth ($CurrentDepth + 1)\n            } else {\n                # Filter by minimum size\n                if (($item.Length / 1KB) -ge $MinSizeKB) {\n                    $item\n                }\n            }\n        }\n    } catch {\n        Write-Warning \"Cannot access directory: $DirectoryPath - $($_.Exception.Message)\"\n    }\n}\n\n# Main execution\nWrite-Host \"Safe Delete Analyzer - Starting analysis...\" -ForegroundColor Green\nWrite-Host \"Parameters:\"\nWrite-Host \"  Paths: $($Path -join ', ')\"\nWrite-Host \"  Minimum Size: $MinSizeKB KB\"\nWrite-Host \"  Exclude System: $ExcludeSystem\"\nWrite-Host \"  Max Depth: $(if ($MaxDepth -ge 0) { $MaxDepth } else { 'Unlimited' })\"\nWrite-Host \"  Output: $OutputPath\"\nWrite-Host \"\"\n\n$results = @()\n$totalFiles = 0\n$totalSize = 0\n\nforeach ($scanPath in $Path) {\n    if (-not (Test-Path $scanPath)) {\n        Write-Warning \"Path not found: $scanPath\"\n        continue\n    }\n    \n    Write-Host \"Scanning: $scanPath\" -ForegroundColor Cyan\n    \n    if (Test-Path $scanPath -PathType Leaf) {\n        # Single file\n        $files = @(Get-Item $scanPath)\n    } else {\n        # Directory\n        $files = Get-DirectoryFiles -DirectoryPath $scanPath\n    }\n    \n    foreach ($file in $files) {\n        $totalFiles++\n        $totalSize += $file.Length\n        \n        if ($totalFiles % 100 -eq 0) {\n            Write-Progress -Activity \"Analyzing Files\" -Status \"Processed $totalFiles files\" -PercentComplete -1\n        }\n        \n        try {\n            $safety = Get-FileSafetyScore -File $file\n            \n            $result = [PSCustomObject]@{\n                'SafetyScore' = $safety.Score\n                'SafetyLevel' = $safety.SafetyLevel\n                'FileName' = $file.Name\n                'FullPath' = $file.FullName\n                'SizeKB' = [Math]::Round($file.Length / 1KB, 2)\n                'SizeMB' = [Math]::Round($file.Length / 1MB, 2)\n                'DateCreated' = $file.CreationTime\n                'DateModified' = $file.LastWriteTime\n                'DateAccessed' = $file.LastAccessTime\n                'Extension' = $file.Extension\n                'Directory' = $file.DirectoryName\n                'SafetyFactors' = $safety.Factors\n            }\n            \n            $results += $result\n        } catch {\n            Write-Warning \"Error analyzing file $($file.FullName): $($_.Exception.Message)\"\n        }\n    }\n}\n\nWrite-Progress -Activity \"Analyzing Files\" -Completed\n\n# Sort results by safety score (highest first)\n$results = $results | Sort-Object SafetyScore -Descending\n\n# Export to CSV\n$results | Export-Csv -Path $OutputPath -NoTypeInformation -Encoding UTF8\n\n# Display summary\nWrite-Host \"\"\nWrite-Host \"Analysis Complete!\" -ForegroundColor Green\nWrite-Host \"==================\" -ForegroundColor Green\nWrite-Host \"Total Files Analyzed: $totalFiles\"\nWrite-Host \"Total Size: $([Math]::Round($totalSize / 1MB, 2)) MB\"\nWrite-Host \"Report saved to: $OutputPath\"\nWrite-Host \"\"\n\n# Safety level breakdown\n$breakdown = $results | Group-Object SafetyLevel | Sort-Object Name\nWrite-Host \"Safety Level Breakdown:\" -ForegroundColor Yellow\nforeach ($group in $breakdown) {\n    $totalSizeMB = ($group.Group | Measure-Object SizeMB -Sum).Sum\n    Write-Host \"  $($group.Name): $($group.Count) files ($([Math]::Round($totalSizeMB, 2)) MB)\"\n}\n\nWrite-Host \"\"\nWrite-Host \"Top 10 Safest Files to Delete:\" -ForegroundColor Yellow\n$results | Select-Object -First 10 | Format-Table SafetyScore, SafetyLevel, FileName, SizeMB, DateModified -AutoSize\n\nWrite-Host \"\"\nWrite-Host \"Files with Safety Score >= 90 (Very Safe):\" -ForegroundColor Green\n$verySafe = $results | Where-Object { $_.SafetyScore -ge 90 }\nif ($verySafe) {\n    $verySafeSizeMB = ($verySafe | Measure-Object SizeMB -Sum).Sum\n    Write-Host \"Count: $($verySafe.Count) files\"\n    Write-Host \"Total Size: $([Math]::Round($verySafeSizeMB, 2)) MB\"\n} else {\n    Write-Host \"No files found with Very Safe rating.\"\n}\n\nWrite-Host \"\"\nWrite-Host \"Review the full report at: $OutputPath\" -ForegroundColor Cyan\n"}], "analysis_scores": {"Performance Analysis": {"score": 62, "max_score": 100.0, "notes": ["+ Uses ErrorAction SilentlyContinue (prevents performance hits from errors)", "+ Uses -File parameter for efficient enumeration", "+ Implements result limiting for memory efficiency", "+ Shows evidence of caching/pre-computation", "- String operations in loops may impact performance", "- Contains nested loops (1) - potential O(n\u00b2) complexity"], "details": {"total_lines": 361, "has_error_action": true, "uses_file_parameter": true, "has_result_limiting": true, "has_caching": true, "string_ops_in_loops": true, "nested_loops": 1, "algorithmic_complexity": "O(n\u00b2)"}}, "Readability Analysis": {"score": 100, "max_score": 100.0, "notes": ["Adequate commenting (>5% comment ratio)", "Includes PowerShell help documentation", "Comprehensive help documentation", "Uses descriptive variable names", "Well-organized with 2 functions", "Good logical sectioning with comments", "Good code indentation"], "details": {"comment_ratio": 0.07756232686980609, "comment_lines": 28, "has_help_block": true, "help_sections_count": 5, "total_variables": 202, "meaningful_variable_ratio": 1.0, "short_variables": [], "function_count": 2, "section_comments": 27, "indentation_ratio": 0.7313019390581718, "mixed_indentation": false}}, "Code Quality Analysis": {"score": 95, "max_score": 100.0, "notes": ["+ Implements try-catch error handling", "+ Uses Parameter attributes", "+ Supports pipeline input", "+ Uses type hints (6 found)", "+ Well-organized with 2 functions", "+ Consistent code indentation", "+ Uses approved PowerShell verbs", "+ Uses CmdletBinding for advanced functions", "+ Uses proper parameter block", "+ Reasonable line lengths (<10% over 120 chars)", "+ Good variable naming practices"], "details": {"has_try_catch": true, "error_handling_score": 15, "has_parameter_attributes": true, "supports_pipeline": true, "type_hints_count": 6, "has_type_hints": true, "param_validation_score": 20, "function_count": 2, "has_consistent_indentation": true, "organization_score": 15, "uses_approved_verbs": true, "has_cmdletbinding": true, "has_param_block": true, "powershell_practices_score": 15, "long_line_ratio": 0.002770083102493075, "meaningful_variable_ratio": 1.0, "maintainability_score": 10}}, "Documentation Analysis": {"score": 100, "max_score": 100.0, "notes": ["+ Includes README documentation", "+ README contains: usage, examples, features, installation, parameters", "+ README includes code examples", "+ Comprehensive README documentation", "+ Adequate inline commenting (>5% average)", "+ All files have header comments", "+ Good use of section comments", "+ All PowerShell files have help documentation", "+ 1 files have comprehensive help (4+ sections)"], "details": {"readme_count": 1, "readme_sections_found": ["usage", "examples", "features", "installation", "parameters"], "has_code_examples": true, "comprehensive_readme": true, "readme_analysis_score": 40, "average_comment_density": 0.07756232686980609, "files_with_headers": 1, "section_comments": 27, "inline_analysis_score": 20, "files_with_help": 1, "comprehensive_help_files": 1, "total_ps1_files": 1, "help_coverage": 1.0, "help_analysis_score": 30}}, "Requirements Traceability Analysis": {"score": 99.5, "max_score": ["Requirements Implementation: 10/10 (100.0%)", "Mandatory Requirements: 10/10 (100.0%)", "\u2713 All mandatory requirements implemented", "\u2713 Excellent implementation quality", "", "\ud83d\udcca SCORING METHODOLOGY INSIGHTS:", "\u2022 Requirements compliance (binary pass/fail) \u2260 implementation quality (0-100)", "\u2022 Quality scores based on evidence count + implementation depth", "\u2022 Higher evidence count = stronger confidence in requirement fulfillment", "\u2022 Even 'PASS' requirements can vary in quality (94-100% range observed)", "\u2022 Comprehensive implementations score higher than minimal implementations", "\u2022 Example: REQ-006 parameter tracking - detailed vs simple approaches affect scoring"], "notes": {"requirements_total": 10, "requirements_implemented": 10, "mandatory_requirements": 10, "mandatory_implemented": 10, "traceability_matrix": {"requirements": {"REQ-001": {"text": "Script must run on Windows platform", "type": "platform", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-002": {"text": "Must identify files that are safe to delete", "type": "functionality", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 5, "status": "\u2713 PASS"}, "REQ-003": {"text": "Must NOT actually delete files (identification only)", "type": "safety", "mandatory": true, "implemented": true, "quality_score": 95, "evidence_count": 1, "status": "\u2713 PASS"}, "REQ-004": {"text": "Must provide ranking/scoring of safety level", "type": "functionality", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 5, "status": "\u2713 PASS"}, "REQ-005": {"text": "Report must include safety-score field", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 3, "status": "\u2713 PASS"}, "REQ-006": {"text": "Report must include parameters that went into score consideration", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 3, "status": "\u2713 PASS"}, "REQ-007": {"text": "Report must include file name", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-008": {"text": "Report must include file size", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-009": {"text": "Report must include date created", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 4, "status": "\u2713 PASS"}, "REQ-010": {"text": "Report must include date updated/modified", "type": "output", "mandatory": true, "implemented": true, "quality_score": 100, "evidence_count": 3, "status": "\u2713 PASS"}}, "summary": {"total_requirements": 10, "implemented": 10, "not_implemented": 0, "mandatory_met": 10, "optional_met": 0}}, "requirement_traces": [{"id": "REQ-001", "text": "Script must run on Windows platform", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-002", "text": "Must identify files that are safe to delete", "implemented": true, "quality": 100, "evidence_count": 5}, {"id": "REQ-003", "text": "Must NOT actually delete files (identification only)", "implemented": true, "quality": 95, "evidence_count": 1}, {"id": "REQ-004", "text": "Must provide ranking/scoring of safety level", "implemented": true, "quality": 100, "evidence_count": 5}, {"id": "REQ-005", "text": "Report must include safety-score field", "implemented": true, "quality": 100, "evidence_count": 3}, {"id": "REQ-006", "text": "Report must include parameters that went into score consideration", "implemented": true, "quality": 100, "evidence_count": 3}, {"id": "REQ-007", "text": "Report must include file name", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-008", "text": "Report must include file size", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-009", "text": "Report must include date created", "implemented": true, "quality": 100, "evidence_count": 4}, {"id": "REQ-010", "text": "Report must include date updated/modified", "implemented": true, "quality": 100, "evidence_count": 3}]}, "details": {}}, "Security Analysis": {"score": 100, "max_score": ["\u2713 No critical security vulnerabilities detected", "\u2713 No high-risk security issues detected", "\u26a1 4 MEDIUM risk security issues found", "\u26aa Some security practices found (5 detected)", "- MEDIUM: Input Validation (3 instances)", "- MEDIUM: Error Handling (1 instances)", "+ Safe File Operations: 2 instances", "+ Logging Auditing: 3 instances"], "notes": {"security_issues": {"MEDIUM_input_validation": ["param(\n    [Parameter(ValueFromPipeline = $true)", "param(\n        [System.IO.FileInfo]$File\n    )\n    \n    ", "param(\n        [string]$DirectoryPath,\n        [int]$CurrentDepth = 0\n    )\n    \n    "], "MEDIUM_error_handling": ["-ErrorAction SilentlyContinue"]}, "good_practices": {"safe_file_operations": ["Test-Path", "Test-Path"], "logging_auditing": ["Write-Warning", "Write-Warning", "Write-Warning"]}, "files_analyzed": 1, "total_content_length": 11472, "security_score_breakdown": {"critical_issues": 0, "high_risk_issues": 0, "medium_risk_issues": 4, "good_practices_count": 5, "security_categories_analyzed": 11, "practice_categories_found": 2}}, "details": {}}, "Adaptability Analysis": {"score": 13.5, "max_score": ["Configuration Flexibility: 25.0/100", "Cross-Platform Compatibility: 5.0/100", "Extensibility: 15.0/100", "Environment Adaptation: 5.0/100", "Input/Output Flexibility: 15.0/100", "Error Recovery: 10.0/100", "\u274c Limited configuration options", "\u274c Platform-specific limitations", "\u274c Limited extensibility"], "notes": {"configuration_score": 25.0, "cross_platform_score": 5.0, "extensibility_score": 15.0, "environment_adaptation_score": 5.0, "input_output_flexibility_score": 15.0, "error_recovery_score": 10.0, "detailed_notes": ["+ 1 configurable parameters found", "+ 1 configurable parameters found", "+ 3 configurable parameters found", "+ 31 configurable parameters found", "+ Switch parameters for boolean options", "+ Proper path handling methods used", "- Hardcoded paths detected (reduces portability)", "+ PowerShell Core compatibility considered", "+ Some modularity with 2 function(s)", "+ Extension/plugin architecture found", "+ Data-driven processing patterns detected", "+ PowerShell version compatibility checks", "+ Alternative output format available", "+ PowerShell pipeline integration", "+ Customizable output formatting"]}, "details": {}}}}];
        let chartInstances = {};
        let isUpdating = false; // Prevent recursive updates
        
        function updateWeight(categoryId, categoryName, value) {
            if (isUpdating) return;
            
            const newValue = parseInt(value);
            const oldValue = currentWeights[categoryName];
            const difference = newValue - oldValue;
            
            // Update the current weight
            currentWeights[categoryName] = newValue;
            
            // Smart redistribution of remaining weights
            redistributeWeights(categoryName, difference);
            
            // Update UI
            updateAllWeightDisplays();
            
            // Add visual feedback
            highlightChangingWeight(categoryId);
            
            // Recalculate scores
            recalculateScores();
        }
        
        function redistributeWeights(changedCategory, difference) {
            const otherCategories = Object.keys(currentWeights).filter(cat => cat !== changedCategory);
            const totalOtherWeights = otherCategories.reduce((sum, cat) => sum + currentWeights[cat], 0);
            
            if (totalOtherWeights === 0) {
                // If all other weights are 0, distribute evenly
                const remainingWeight = 100 - currentWeights[changedCategory];
                const weightPerCategory = Math.floor(remainingWeight / otherCategories.length);
                let remainder = remainingWeight % otherCategories.length;
                
                otherCategories.forEach((cat, index) => {
                    currentWeights[cat] = weightPerCategory + (index < remainder ? 1 : 0);
                });
            } else {
                // Proportional redistribution
                const targetTotal = 100 - currentWeights[changedCategory];
                const scaleFactor = targetTotal / totalOtherWeights;
                
                otherCategories.forEach(cat => {
                    currentWeights[cat] = Math.round(currentWeights[cat] * scaleFactor);
                });
                
                // Ensure exactly 100% total
                ensureExact100Percent();
            }
        }
        
        function ensureExact100Percent() {
            const total = Object.values(currentWeights).reduce((sum, weight) => sum + weight, 0);
            const difference = 100 - total;
            
            if (difference !== 0) {
                // Find the category with the highest weight to adjust
                const sortedCategories = Object.keys(currentWeights)
                    .sort((a, b) => currentWeights[b] - currentWeights[a]);
                
                currentWeights[sortedCategories[0]] += difference;
            }
        }
        
        function updateAllWeightDisplays() {
            isUpdating = true;
            
            Object.keys(currentWeights).forEach(category => {
                const categoryId = category.toLowerCase().replace(' ', '_').replace('_analysis', '');
                const slider = document.getElementById(categoryId + '_slider');
                const valueDisplay = document.getElementById(categoryId + '_value');
                
                if (slider && valueDisplay) {
                    slider.value = currentWeights[category];
                    valueDisplay.textContent = currentWeights[category] + '%';
                }
            });
            
            // Update total weight display (should always be 100)
            const totalElement = document.getElementById('totalWeight');
            const statusElement = document.getElementById('weightStatus');
            
            totalElement.textContent = '100';
            statusElement.textContent = '‚úì Balanced';
            statusElement.className = 'weight-good';
            
            isUpdating = false;
        }
        
        function highlightChangingWeight(categoryId) {
            const weightItem = document.getElementById(categoryId + '_slider').closest('.weight-item');
            if (weightItem) {
                weightItem.classList.add('changing');
                setTimeout(() => {
                    weightItem.classList.remove('changing');
                }, 300);
            }
        }
        
        // Modal functions
        function openWeightModal() {
            document.getElementById('weightModal').style.display = 'block';
        }
        
        function closeWeightModal() {
            document.getElementById('weightModal').style.display = 'none';
        }
        
        // Preset weight configurations
        const presets = {
            balanced: {
                'Adaptability Analysis': 14,
                'Code Quality Analysis': 14,
                'Documentation Analysis': 14,
                'Performance Analysis': 15,
                'Readability Analysis': 14,
                'Requirements Traceability Analysis': 15,
                'Security Analysis': 14
            },
            security: {
                'Adaptability Analysis': 5,
                'Code Quality Analysis': 15,
                'Documentation Analysis': 10,
                'Performance Analysis': 15,
                'Readability Analysis': 10,
                'Requirements Traceability Analysis': 20,
                'Security Analysis': 25
            },
            performance: {
                'Adaptability Analysis': 15,
                'Code Quality Analysis': 15,
                'Documentation Analysis': 5,
                'Performance Analysis': 30,
                'Readability Analysis': 10,
                'Requirements Traceability Analysis': 15,
                'Security Analysis': 10
            },
            enterprise: {
                'Adaptability Analysis': 8,
                'Code Quality Analysis': 12,
                'Documentation Analysis': 20,
                'Performance Analysis': 15,
                'Readability Analysis': 15,
                'Requirements Traceability Analysis': 25,
                'Security Analysis': 5
            },
            agile: {
                'Adaptability Analysis': 25,
                'Code Quality Analysis': 20,
                'Documentation Analysis': 5,
                'Performance Analysis': 20,
                'Readability Analysis': 15,
                'Requirements Traceability Analysis': 10,
                'Security Analysis': 5
            },
            maintenance: {
                'Adaptability Analysis': 10,
                'Code Quality Analysis': 15,
                'Documentation Analysis': 25,
                'Performance Analysis': 10,
                'Readability Analysis': 25,
                'Requirements Traceability Analysis': 10,
                'Security Analysis': 5
            }
        };
        
        function applyPreset(presetName) {
            const preset = presets[presetName];
            if (preset) {
                // Update weights
                Object.keys(preset).forEach(category => {
                    if (currentWeights.hasOwnProperty(category)) {
                        currentWeights[category] = preset[category];
                    }
                });
                
                // Update displays
                updateAllWeightDisplays();
                
                // Recalculate scores
                recalculateScores();
                
                // Visual feedback
                document.querySelectorAll('.preset-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                event.target.closest('.preset-btn').classList.add('active');
                
                // Show redistribution info
                showRedistributionInfo(`Applied ${presetName} preset`);
            }
        }
        
        function showRedistributionInfo(message) {
            const info = document.createElement('div');
            info.className = 'redistribution-info';
            info.textContent = message;
            info.style.position = 'fixed';
            info.style.top = '20px';
            info.style.right = '20px';
            info.style.zIndex = '1001';
            info.style.padding = '15px';
            info.style.backgroundColor = '#38a169';
            info.style.color = 'white';
            info.style.borderRadius = '8px';
            info.style.boxShadow = '0 4px 12px rgba(0,0,0,0.2)';
            
            document.body.appendChild(info);
            
            setTimeout(() => {
                info.style.opacity = '0';
                setTimeout(() => {
                    if (info.parentNode) {
                        info.parentNode.removeChild(info);
                    }
                }, 300);
            }, 2000);
        }
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('weightModal');
            if (event.target === modal) {
                closeWeightModal();
            }
        }
        
        function recalculateScores() {
            // Recalculate overall scores for each LLM
            const newOverallScores = [];
            const llmNames = ["llm1", "llm2", "llm3", "llm4"];
            
            originalScores.forEach((result, index) => {
                let weightedSum = 0;
                let totalWeight = 0;
                
                const analysisScores = result.analysis_scores || {};
                Object.keys(currentWeights).forEach(category => {
                    const weight = currentWeights[category] / 100;
                    const score = analysisScores[category]?.score || 0;
                    weightedSum += score * weight;
                    totalWeight += weight;
                });
                
                const overallScore = totalWeight > 0 ? weightedSum / totalWeight : 0;
                newOverallScores.push(overallScore);
                
                // Update the score display in the table
                const scoreElement = document.querySelector(`#score-${result.llm_name}`);
                if (scoreElement) {
                    scoreElement.textContent = overallScore.toFixed(1);
                }
            });
            
            // Sort results by new scores and update rankings
            const sortedResults = originalScores.map((result, index) => ({
                ...result,
                newScore: newOverallScores[index]
            })).sort((a, b) => b.newScore - a.newScore);
            
            // Update table rankings
            updateTableRankings(sortedResults);
            
            // Update charts
            updateCharts(llmNames, newOverallScores);
        }
        
        function updateTableRankings(sortedResults) {
            // Update rank numbers in the table
            sortedResults.forEach((result, index) => {
                const rankElement = document.querySelector(`#rank-${result.llm_name}`);
                if (rankElement) {
                    rankElement.textContent = `#${index + 1}`;
                }
            });
        }
        
        function updateCharts(llmNames, newScores) {
            // Update overall performance chart
            if (chartInstances.overallChart) {
                chartInstances.overallChart.data.datasets[0].data = newScores;
                chartInstances.overallChart.update();
            }
            
            // Update category chart with new weights
            if (chartInstances.categoryChart) {
                // Recalculate category data with new weights
                const categoryData = [];
                const categories = Object.keys(currentWeights);
                
                llmNames.forEach(llmName => {
                    const result = originalScores.find(r => r.llm_name === llmName);
                    const scores = [];
                    categories.forEach(category => {
                        const score = result?.analysis_scores[category]?.score || 0;
                        scores.push(score);
                    });
                    categoryData.push(scores);
                });
                
                // Update the chart datasets
                categoryData.forEach((scores, index) => {
                    if (chartInstances.categoryChart.data.datasets[index]) {
                        chartInstances.categoryChart.data.datasets[index].data = scores;
                    }
                });
                
                chartInstances.categoryChart.update();
            }
        }
        
        // Overall Performance Chart
        const overallCtx = document.getElementById('overallChart').getContext('2d');
        chartInstances.overallChart = new Chart(overallCtx, {
            type: 'bar',
            data: {
                labels: ["llm1", "llm2", "llm3", "llm4"],
                datasets: [{
                    label: 'Overall Score',
                    data: [83.88636363636364, 75.79545454545453, 81.4590909090909, 82.93181818181817],
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.8)',
                        'rgba(54, 162, 235, 0.8)',
                        'rgba(255, 205, 86, 0.8)',
                        'rgba(75, 192, 192, 0.8)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 205, 86, 1)',
                        'rgba(75, 192, 192, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.parsed.y.toFixed(1) + '%';
                            }
                        }
                    }
                }
            }
        });
        
        // Category Comparison Chart
        const categoryCtx = document.getElementById('categoryChart').getContext('2d');
        chartInstances.categoryChart = new Chart(categoryCtx, {
            type: 'radar',
            data: {
                labels: ["Adaptability", "Code Quality", "Documentation", "Performance", "Readability", "Requirements Traceability", "Security"],
                datasets: [{"label": "llm1", "data": [39.5, 75, 70, 74, 93, 99.5, 100], "backgroundColor": "rgba(255, 99, 132, 0.8)", "borderColor": "rgba(255, 99, 132, 1)", "borderWidth": 2, "fill": true, "pointRadius": 4}, {"label": "llm2", "data": [27.5, 64, 60, 55, 93, 98.9, 94.0], "backgroundColor": "rgba(54, 162, 235, 0.8)", "borderColor": "rgba(54, 162, 235, 1)", "borderWidth": 2, "fill": true, "pointRadius": 4}, {"label": "llm3", "data": [31.8, 78, 100, 55, 100, 99.5, 100], "backgroundColor": "rgba(255, 205, 86, 0.8)", "borderColor": "rgba(255, 205, 86, 1)", "borderWidth": 2, "fill": true, "pointRadius": 4}, {"label": "llm4", "data": [13.5, 95, 100, 62, 100, 99.5, 100], "backgroundColor": "rgba(75, 192, 192, 0.8)", "borderColor": "rgba(75, 192, 192, 1)", "borderWidth": 2, "fill": true, "pointRadius": 4}]
            },
            options: {
                responsive: true,
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.dataset.label + ': ' + context.parsed.r.toFixed(1) + '%';
                            }
                        }
                    }
                }
            }
        });
        
        // Toggle details functionality
        function toggleDetails(id) {
            const content = document.getElementById(id);
            const isVisible = content.style.display === 'block';
            content.style.display = isVisible ? 'none' : 'block';
        }
    </script>
</body>
</html>